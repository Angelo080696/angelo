(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5172],{3115:(e,t,n)=>{"use strict";n.d(t,{k5:()=>r,HC:()=>i,f$:()=>a});var s=n(87386),o=n(82059);let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{docFlags:{}};return(0,s.createDocWithCards)(t,[{type:"card",content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"title",attrs:{level:o.f.DefaultTitle}},{type:"contributors"}]}]},{type:"card",content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"heading"}]}]}])},r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.createDocWithCards)(e,[{type:"card",content:[{type:"cardLayoutItem",attrs:{itemId:"body"},content:[{type:"title",attrs:{level:o.f.DefaultTitle}}]}]}])},a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{docFlags:{}};return{type:"doc",content:[{type:"document",attrs:t,content:[{type:"card",content:[{type:"title",attrs:{level:o.f.DefaultTitle}},{type:"contributors"}]},{type:"card",attrs:{previewContent:null,background:{type:"none"},container:{},cardSize:"default",layout:"blank"},content:[{type:"heading",attrs:{horizontalAlign:null,level:2},content:[{type:"text",text:"Quick Start Checklist"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"zap",native:"⚡"}},{type:"text",text:"️ "},{type:"text",marks:[{type:"bold"}],text:"Type "},{type:"text",marks:[{type:"code"}],text:"/"},{type:"text",marks:[{type:"bold"}],text:" in a card to open the slash menu"}]},{type:"bullet",attrs:{indent:1,fontSize:null},content:[{type:"text",text:"It lets you browse and add content blocks quickly"}]},{type:"bullet",attrs:{indent:1,fontSize:null},content:[{type:"text",text:"Content blocks can be added from the "},{type:"text",marks:[{type:"footnoteLabel",attrs:{noteId:"7jZEg"}}],text:"insert menu"},{type:"footnote",attrs:{noteId:"7jZEg"},content:[{type:"image",attrs:{id:"Y3FmX",horizontalAlign:null,src:"https://cdn.gamma.app/zc87vhr30n8uf3n/b98e59519a994c7abd900f44683bbb5d/optimized/insert-menu-explainer.gif",tempUrl:"blob:https://gamma.app/983566b4-f21e-4d28-bc69-d448c1976833",uploadStatus:0,meta:{width:700,height:459,date_file_modified:"2023/01/20 23:08:42 GMT",duration:4.42,aspect_ratio:1.525,has_clipping_path:!1,frame_count:36,colorspace:"RGB",average_color:"#f7f5f5"},providerMeta:null,name:"insert-menu-explainer.gif",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null}}}]},{type:"text",text:" if you prefer to drag"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"heavy_plus_sign",native:"➕"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Add a new card"},{type:"text",text:" (type "},{type:"text",marks:[{type:"code"}],text:"/card"},{type:"text",text:") or select a template via the "},{type:"text",marks:[{type:"footnoteLabel",attrs:{noteId:"xLt8J"}}],text:"plus button"},{type:"footnote",attrs:{noteId:"xLt8J"},content:[{type:"image",attrs:{id:"3CSXR",horizontalAlign:null,src:"https://cdn.gamma.app/zc87vhr30n8uf3n/a8d6b7149f75401ebd54e6b022670a3e/optimized/image.png",tempUrl:"blob:https://gamma.app/5368f25a-cf30-4410-bf62-bd26080b01f5",uploadStatus:0,meta:{width:844,height:608,date_file_modified:"2023/01/20 21:38:09 GMT",aspect_ratio:1.388,has_clipping_path:!1,frame_count:1,colorspace:"RGB",average_color:"#f7f5f5"},providerMeta:null,name:"image.png",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null}}}]}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"newspaper",native:"\uD83D\uDCF0"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Create multi-column layouts"},{type:"text",text:" (type "},{type:"text",marks:[{type:"code"}],text:"/columns"},{type:"text",text:") or "},{type:"text",marks:[{type:"footnoteLabel",attrs:{noteId:"JyryA"}}],text:"drag blocks"},{type:"footnote",attrs:{noteId:"JyryA"},content:[{type:"image",attrs:{id:"iJXTh",horizontalAlign:null,src:"https://cdn.gamma.app/zc87vhr30n8uf3n/3e47c137ba5d4d13bdafda584b3a8f94/optimized/drag-columns-optimized.gif",tempUrl:"blob:https://gamma.app/654cd2e0-6972-4a24-a7c0-25eff0cf9050",uploadStatus:0,meta:{width:500,height:313,date_file_modified:"2023/01/20 21:35:04 GMT",duration:9.83,aspect_ratio:1.597,has_clipping_path:!1,frame_count:62,colorspace:"RGB",average_color:"#e8cac5"},providerMeta:null,name:"drag-columns-optimized.gif",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null}}}]},{type:"text",text:" side by side"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"bridge_at_night",native:"\uD83C\uDF09"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Add an image "},{type:"text",text:"(type "},{type:"text",marks:[{type:"code"}],text:"/image"},{type:"text",text:"). You can drag in or paste image files too!"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"art",native:"\uD83C\uDFA8"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Change the deck "},{type:"text",marks:[{type:"bold"},{type:"footnoteLabel",attrs:{noteId:"mTOBc"}}],text:"theme"},{type:"footnote",attrs:{noteId:"mTOBc"},content:[{type:"paragraph",attrs:{horizontalAlign:null,fontSize:null},content:[{type:"text",text:"Click the "},{type:"text",marks:[{type:"code"}],text:"Theme"},{type:"text",text:" button in the top toolbar, then try clicking some of the different options"}]},{type:"image",attrs:{id:"GHNdu",horizontalAlign:"center",src:"https://cdn.gamma.app/zc87vhr30n8uf3n/db839cee72b7497b9ff1424987641ed5/optimized/image.png",tempUrl:null,uploadStatus:0,meta:{width:806,height:1678,date_file_modified:"2022/08/01 23:13:09 GMT",aspect_ratio:.48,has_clipping_path:!1,frame_count:1,colorspace:"RGB",average_color:"#ccc7ca"},providerMeta:null,name:"image.png",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:"inset",clipPath:["17.31441903150651%","0%","41.5572854690296%","0%"],clipAspectRatio:1.1678975712005124,width:209.77777777777777}}}]},{type:"text",text:" to give it a different look and feel"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"arrow_forward",native:"▶️"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Try present mode"},{type:"text",text:" and use your arrow keys and "},{type:"text",marks:[{type:"footnoteLabel",attrs:{noteId:"UGnAU"}}],text:"spotlight"},{type:"footnote",attrs:{noteId:"UGnAU"},content:[{type:"paragraph",attrs:{horizontalAlign:null,fontSize:null},content:[{type:"text",text:"Spotlight lets you"},{type:"text",marks:[{type:"bold"}],text:" focus "},{type:"text",text:"on"},{type:"text",marks:[{type:"bold"}],text:" one piece of content at a time. "},{type:"text",text:"While presenting, press "},{type:"text",marks:[{type:"code"}],text:"s"},{type:"text",text:" to enter spotlight mode."}]},{type:"image",attrs:{id:"YOFhU",horizontalAlign:null,src:"https://cdn.gamma.app/zc87vhr30n8uf3n/ed0b362f6c2f4a438cd3188ba7697a02/optimized/spotlight-compressed.gif",tempUrl:"blob:https://gamma.app/d2eaae7f-515e-4e06-b396-4b0551a5a999",uploadStatus:0,meta:{width:1200,height:750,date_file_modified:"2023/01/13 21:48:00 GMT",duration:6.66,aspect_ratio:1.6,has_clipping_path:!1,frame_count:34,colorspace:"RGB",average_color:"#323030"},providerMeta:null,name:"spotlight-compressed.gif",query:null,source:"image.custom",showPlaceholder:!1,fullWidthBlock:!1,resize:{clipType:null,clipPath:null,clipAspectRatio:null,width:null}}}]},{type:"text",text:" to move around"}]},{type:"todo",attrs:{indent:0,checked:!1,fontSize:null},content:[{type:"emoji",attrs:{id:"tada",native:"\uD83C\uDF89"}},{type:"text",text:" "},{type:"text",marks:[{type:"bold"}],text:"Share your deck"},{type:"text",text:"."},{type:"text",marks:[{type:"bold"}],text:" "},{type:"text",text:"Publish it to the world, invite others, or export a PDF"}]}]}]}]}}},5291:(e,t,n)=>{"use strict";n.d(t,{b9:()=>p,go:()=>u,iJ:()=>d,iO:()=>h});var s=n(55729),o=n(22275),i=n(15342),r=n(86497),a=n(58859),c=n(34647),l=n(25991);let d=()=>{let e=(0,s.useRef)("unsynced"),t=(0,i.CU)(),n=(0,r.O)(),c=(0,s.useCallback)(async(s,o,i)=>{if((0,l.yy)(t.getState())||n){if("unsynced"!==e.current)return void console.warn("Cannot load doc from cache when it is already ".concat(e.current));await (0,a.f)().loadYDoc(s,o)&&(e.current="loaded",i())}},[n,t]),d=(0,s.useCallback)((s,i)=>{if(!((0,l.yy)(t.getState())||n))return;let r=(0,o.S)();if("unsynced"!==e.current)return void console.warn("Cannot sync doc to cache when it is already ".concat(e.current));r&&(0,a.f)().syncYDoc(s,i)},[n,t]);return(0,s.useMemo)(()=>({loadYDoc:c,syncYDoc:d}),[c,d])},u=()=>{let e=(0,i.jL)(),t=(0,i.CU)();return(0,s.useCallback)(function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date().toISOString();(0,l.yy)(t.getState())&&e((0,l.KT)({docIds:n,lastSynced:s}))},[e,t])},h=()=>{let e=(0,i.jL)(),t=(0,i.CU)();return(0,s.useCallback)(function(n){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date().toISOString();if((0,l.yy)(t.getState()))return e((0,l.yK)({docId:n,lastSynced:s}))},[e,t])},p=()=>(0,s.useMemo)(()=>(0,c.S)(),[])},10612:(e,t,n)=>{var s=n(15757),o=n(63888),i=n(98888),r=n(60567);e.exports=function(e,t,n){e=r(e);var a=(t=i(t))?o(e):0;return t&&a<t?s(t-a,n)+e:e}},15757:(e,t,n)=>{var s=n(64806),o=n(16153),i=n(2603),r=n(9819),a=n(63888),c=n(18053),l=Math.ceil;e.exports=function(e,t){var n=(t=void 0===t?" ":o(t)).length;if(n<2)return n?s(t,e):t;var d=s(t,l(e/a(t)));return r(t)?i(c(d),0,e).join(""):d.slice(0,e)}},25172:(e,t,n)=>{"use strict";let s;n.d(t,{H2:()=>oj,bw:()=>tJ.b,u5:()=>oU.u,k5:()=>oN.k5,HC:()=>oN.HC,f$:()=>oN.f$});var o,i,r,a,c=n(97255);c.Lz.prototype.updateState=function(e){this.docView&&this.updateStateInner(e,this.state.plugins!=e.plugins)};var l=n(6029),d=n(66425),u=n(26028),h=n(29328),p=n(53295),g=n(94283);let f=Math.floor,m=(e,t)=>e<t?e:t,y=(e,t)=>e>t?e:t,b=Number.MAX_SAFE_INTEGER,w="undefined"!=typeof TextEncoder?new TextEncoder:null,v=w?e=>w.encode(e):e=>{let t=unescape(encodeURIComponent(e)),n=t.length,s=new Uint8Array(n);for(let e=0;e<n;e++)s[e]=t.codePointAt(e);return s},S="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});S&&1===S.decode(new Uint8Array).length&&(S=null);let x=(e,t)=>{let n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},C=(e,t)=>{for(;t>127;)x(e,128|127&t),t=f(t/128);x(e,127&t)},A=new Uint8Array(3e4),k=A.length/3,E=w&&w.encodeInto?(e,t)=>{if(t.length<k){let n=w.encodeInto(t,A).written||0;C(e,n);for(let t=0;t<n;t++)x(e,A[t])}else D(e,v(t))}:(e,t)=>{let n=unescape(encodeURIComponent(t)),s=n.length;C(e,s);for(let t=0;t<s;t++)x(e,n.codePointAt(t))},T=(e,t)=>{let n=e.cbuf.length,s=e.cpos,o=m(n-s,t.length),i=t.length-o;e.cbuf.set(t.subarray(0,o),s),e.cpos+=o,i>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(y(2*n,i)),e.cbuf.set(t.subarray(o)),e.cpos=i)},D=(e,t)=>{C(e,t.byteLength),T(e,t)},P=e=>Error(e),M=P("Unexpected end of array"),O=P("Integer out of Range"),I=(e,t)=>{let n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},R=e=>I(e,j(e)),_=e=>e.arr[e.pos++],j=e=>{let t=0,n=1,s=e.arr.length;for(;e.pos<s;){let s=e.arr[e.pos++];if(t+=(127&s)*n,n*=128,s<128)return t;if(t>b)throw O}throw M},N=S?e=>S.decode(R(e)):e=>{let t=j(e);if(0===t)return"";{let n=String.fromCodePoint(_(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(_(e));else for(;t>0;){let s=t<1e4?t:1e4,o=e.arr.subarray(e.pos,e.pos+s);e.pos+=s,n+=String.fromCodePoint.apply(null,o),t-=s}return decodeURIComponent(escape(n))}};!function(e){e[e.Token=0]="Token",e[e.PermissionDenied=1]="PermissionDenied",e[e.Authenticated=2]="Authenticated"}(o||(o={}));let U=(e,t)=>{C(e,o.Token),E(e,t)},L=(e,t,n)=>{switch(j(e)){case o.PermissionDenied:t(N(e));break;case o.Authenticated:n(N(e))}},z={code:1009},H={code:4401,reason:"Unauthorized"},F={code:4403},B=e=>Array.from(e.entries()).map(([e,t])=>({clientId:e,...t}));!function(e){e[e.Connecting=0]="Connecting",e[e.Open=1]="Open",e[e.Closing=2]="Closing",e[e.Closed=3]="Closed"}(i||(i={}));var V=n(59023);async function G(e){return new Promise((t,n)=>{setTimeout(t,e)})}function W(e,t){let n=t.delay;if(0===n)return 0;if(t.factor&&(n*=Math.pow(t.factor,e.attemptNum-1),0!==t.maxDelay&&(n=Math.min(n,t.maxDelay))),t.jitter){let e=Math.ceil(t.minDelay);n=Math.floor(Math.random()*(Math.floor(n)-e+1))+e}return Math.round(n)}async function $(e,t){var n;let s=((n=t)||(n={}),{delay:void 0===n.delay?200:n.delay,initialDelay:void 0===n.initialDelay?0:n.initialDelay,minDelay:void 0===n.minDelay?0:n.minDelay,maxDelay:void 0===n.maxDelay?0:n.maxDelay,factor:void 0===n.factor?0:n.factor,maxAttempts:void 0===n.maxAttempts?3:n.maxAttempts,timeout:void 0===n.timeout?0:n.timeout,jitter:!0===n.jitter,handleError:void 0===n.handleError?null:n.handleError,handleTimeout:void 0===n.handleTimeout?null:n.handleTimeout,beforeAttempt:void 0===n.beforeAttempt?null:n.beforeAttempt,calculateDelay:void 0===n.calculateDelay?null:n.calculateDelay});for(let e of["delay","initialDelay","minDelay","maxDelay","maxAttempts","timeout"]){let t=s[e];if(!Number.isInteger(t)||t<0)throw Error(`Value for ${e} must be an integer greater than or equal to 0`)}if(s.factor.constructor!==Number||s.factor<0)throw Error("Value for factor must be a number greater than or equal to 0");if(s.delay<s.minDelay)throw Error(`delay cannot be less than minDelay (delay: ${s.delay}, minDelay: ${s.minDelay}`);let o={attemptNum:0,attemptsRemaining:s.maxAttempts?s.maxAttempts:-1,aborted:!1,abort(){o.aborted=!0}},i=s.calculateDelay||W;async function r(){if(s.beforeAttempt&&s.beforeAttempt(o,s),o.aborted){let e=Error("Attempt aborted");throw e.code="ATTEMPT_ABORTED",e}let t=async e=>{if(s.handleError&&await s.handleError(e,o,s),o.aborted||0===o.attemptsRemaining)throw e;o.attemptNum++;let t=i(o,s);return t&&await G(t),r()};return(o.attemptsRemaining>0&&o.attemptsRemaining--,s.timeout)?new Promise((n,i)=>{let r=setTimeout(()=>{if(s.handleTimeout)try{n(s.handleTimeout(o,s))}catch(e){i(e)}else{let e=Error(`Retry timeout (attemptNum: ${o.attemptNum}, timeout: ${s.timeout})`);e.code="ATTEMPT_TIMEOUT",i(e)}},s.timeout);e(o,s).then(e=>{clearTimeout(r),n(e)}).catch(e=>{clearTimeout(r),t(e).then(n).catch(i)})}):e(o,s).catch(t)}let a=s.calculateDelay?s.calculateDelay(o,s):s.initialDelay;return a&&await G(a),r()}var Y=n(29143),J=n(51642).hp;let q=()=>new Map,Q=(e,t,n)=>{let s=e.get(t);return void 0===s&&e.set(t,s=n()),s},Z=()=>new Set,K=Array.from,X=String.fromCharCode,ee=e=>e.toLowerCase(),et=/^\s*/g,en=e=>e.replace(et,""),es=/([A-Z])/g,eo=(e,t)=>en(e.replace(es,e=>`${t}${ee(e)}`)),ei="undefined"!=typeof TextEncoder?new TextEncoder:null,er=ei?e=>ei.encode(e):e=>{let t=unescape(encodeURIComponent(e)),n=t.length,s=new Uint8Array(n);for(let e=0;e<n;e++)s[e]=t.codePointAt(e);return s},ea="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});ea&&1===ea.decode(new Uint8Array).length&&(ea=null);let ec=e=>void 0===e?null:e;class el{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let ed=new el,eu=!0;try{"undefined"!=typeof localStorage&&localStorage&&(ed=localStorage,eu=!1)}catch(e){}let eh=ed,ep=e=>eu||addEventListener("storage",e),eg=e=>eu||removeEventListener("storage",e),ef=Object.keys,em=(e,t)=>{let n=[];for(let s in e)n.push(t(e[s],s));return n},ey=e=>ef(e).length,eb=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),ew=(e,t)=>e===t,ev=(e,t)=>{if(null==e||null==t)return ew(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break;case Set:if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;break;case Map:if(e.size!==t.size)return!1;for(let n of e.keys())if(!t.has(n)||!ev(e.get(n),t.get(n)))return!1;break;case Object:if(ey(e)!==ey(t))return!1;for(let n in e)if(!eb(e,n)||!ev(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!ev(e[n],t[n]))return!1;break;default:return!1}return!0},eS=void 0!==Y&&Y.release&&/node|io\.js/.test(Y.release.name)&&"[object process]"===Object.prototype.toString.call(void 0!==Y?Y:0),ex="undefined"!=typeof window&&"undefined"!=typeof document&&!eS;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);let eC=()=>{if(void 0===s)if(eS){s=q();let e=Y.argv,t=null;for(let n=0;n<e.length;n++){let o=e[n];"-"===o[0]?(null!==t&&s.set(t,""),t=o):null!==t&&(s.set(t,o),t=null)}null!==t&&s.set(t,"")}else"object"==typeof location?(s=q(),(location.search||"?").slice(1).split("&").forEach(e=>{if(0!==e.length){let[t,n]=e.split("=");s.set(`--${eo(t,"-")}`,n),s.set(`-${eo(t,"-")}`,n)}})):s=q();return s},eA=e=>eC().has(e),ek=e=>eS?ec(Y.env[e.toUpperCase()]):ec(eh.getItem(e));(e=>eA("--"+e)||ek(e))("production");let eE=eS&&["true","1","2"].includes(Y.env.FORCE_COLOR);!eA("no-colors")&&(!eS||Y.stdout.isTTY||eE)&&(!eS||eA("color")||eE||null!==ek("COLORTERM")||(ek("TERM")||"").includes("color"));let eT=Math.floor,eD=(e,t)=>e<t?e:t,eP=(e,t)=>e>t?e:t,eM=Number.MAX_SAFE_INTEGER;class eO{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}let eI=()=>new eO,eR=e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t},e_=e=>{let t=new Uint8Array(eR(e)),n=0;for(let s=0;s<e.bufs.length;s++){let o=e.bufs[s];t.set(o,n),n+=o.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},ej=(e,t)=>{let n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},eN=(e,t)=>{for(;t>127;)ej(e,128|127&t),t=eT(t/128);ej(e,127&t)},eU=new Uint8Array(3e4),eL=eU.length/3,ez=ei&&ei.encodeInto?(e,t)=>{if(t.length<eL){let n=ei.encodeInto(t,eU).written||0;eN(e,n);for(let t=0;t<n;t++)ej(e,eU[t])}else eF(e,er(t))}:(e,t)=>{let n=unescape(encodeURIComponent(t)),s=n.length;eN(e,s);for(let t=0;t<s;t++)ej(e,n.codePointAt(t))},eH=(e,t)=>{let n=e.cbuf.length,s=e.cpos,o=eD(n-s,t.length),i=t.length-o;e.cbuf.set(t.subarray(0,o),s),e.cpos+=o,i>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(eP(2*n,i)),e.cbuf.set(t.subarray(o)),e.cpos=i)},eF=(e,t)=>{eN(e,t.byteLength),eH(e,t)},eB=e=>Error(e),eV=eB("Unexpected end of array"),eG=eB("Integer out of Range");class eW{constructor(e){this.arr=e,this.pos=0}}let e$=e=>new eW(e),eY=(e,t)=>{let n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,n},eJ=e=>eY(e,eQ(e)),eq=e=>e.arr[e.pos++],eQ=e=>{let t=0,n=1,s=e.arr.length;for(;e.pos<s;){let s=e.arr[e.pos++];if(t+=(127&s)*n,n*=128,s<128)return t;if(t>eM)throw eG}throw eV},eZ=e=>{let t=e.arr[e.pos++],n=63&t,s=64,o=(64&t)>0?-1:1;if((128&t)==0)return o*n;let i=e.arr.length;for(;e.pos<i;){if(n+=(127&(t=e.arr[e.pos++]))*s,s*=128,t<128)return o*n;if(n>eM)throw eG}throw eV},eK=ea?e=>ea.decode(eJ(e)):e=>{let t=eQ(e);if(0===t)return"";{let n=String.fromCodePoint(eq(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(eq(e));else for(;t>0;){let s=t<1e4?t:1e4,o=e.arr.subarray(e.pos,e.pos+s);e.pos+=s,n+=String.fromCodePoint.apply(null,o),t-=s}return decodeURIComponent(escape(n))}},eX=e=>{let t=e.pos,n=eK(e);return e.pos=t,n},e0=e=>new Uint8Array(e),e1=(e,t,n)=>new Uint8Array(e,t,n),e2=e=>new Uint8Array(e),e8=ex?e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=X(e[n]);return btoa(t)}:e=>J.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),e3=ex?e=>{let t=atob(e),n=e0(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}:e=>{let t=J.from(e,"base64");return e1(t.buffer,t.byteOffset,t.byteLength)},e6=new Map;class e5{constructor(e){this.room=e,this.onmessage=null,this._onChange=t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:e3(t.newValue||"")}),ep(this._onChange)}postMessage(e){eh.setItem(this.room,e8(e2(e)))}close(){eg(this._onChange)}}let e4="undefined"==typeof BroadcastChannel?e5:BroadcastChannel,e7=e=>Q(e6,e,()=>{let t=Z(),n=new e4(e);return n.onmessage=e=>t.forEach(t=>t(e.data,"broadcastchannel")),{bc:n,subs:t}}),e9=(e,t)=>(e7(e).subs.add(t),t),te=(e,t)=>{let n=e7(e),s=n.subs.delete(t);return s&&0===n.subs.size&&(n.bc.close(),e6.delete(e)),s},tt=(e,t,n=null)=>{let s=e7(e);s.bc.postMessage(t),s.subs.forEach(e=>e(t,n))},tn=()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else void 0!==n&&n()}},ts=Date.now;class to{constructor(){this._observers=q()}on(e,t){Q(this._observers,e,Z).add(t)}once(e,t){let n=(...s)=>{this.off(e,n),t(...s)};this.on(e,n)}off(e,t){let n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}emit(e,t){return K((this._observers.get(e)||q()).values()).forEach(e=>e(...t))}destroy(){this._observers=q()}}class ti extends to{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{let e=ts();null!==this.getLocalState()&&15e3<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());let t=[];this.meta.forEach((n,s)=>{s!==this.clientID&&3e4<=e-n.lastUpdated&&this.states.has(s)&&t.push(s)}),t.length>0&&tr(this,t,"timeout")},eT(3e3)),e.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){let t=this.clientID,n=this.meta.get(t),s=void 0===n?0:n.clock+1,o=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:s,lastUpdated:ts()});let i=[],r=[],a=[],c=[];null===e?c.push(t):null==o?null!=e&&i.push(t):(r.push(t),ev(o,e)||a.push(t)),(i.length>0||a.length>0||c.length>0)&&this.emit("change",[{added:i,updated:a,removed:c},"local"]),this.emit("update",[{added:i,updated:r,removed:c},"local"])}setLocalStateField(e,t){let n=this.getLocalState();null!==n&&this.setLocalState({...n,[e]:t})}getStates(){return this.states}}let tr=(e,t,n)=>{let s=[];for(let n=0;n<t.length;n++){let o=t[n];if(e.states.has(o)){if(e.states.delete(o),o===e.clientID){let t=e.meta.get(o);e.meta.set(o,{clock:t.clock+1,lastUpdated:ts()})}s.push(o)}}s.length>0&&(e.emit("change",[{added:[],updated:[],removed:s},n]),e.emit("update",[{added:[],updated:[],removed:s},n]))},ta=(e,t,n=e.states)=>{let s=t.length,o=eI();eN(o,s);for(let i=0;i<s;i++){let s=t[i],r=n.get(s)||null,a=e.meta.get(s).clock;eN(o,s),eN(o,a),ez(o,JSON.stringify(r))}return e_(o)},tc=(e,t,n)=>{let s=e$(t),o=ts(),i=[],r=[],a=[],c=[],l=eQ(s);for(let t=0;t<l;t++){let t=eQ(s),n=eQ(s),l=JSON.parse(eK(s)),d=e.meta.get(t),u=e.states.get(t),h=void 0===d?0:d.clock;(h<n||h===n&&null===l&&e.states.has(t))&&(null===l?t===e.clientID&&null!=e.getLocalState()?n++:e.states.delete(t):e.states.set(t,l),e.meta.set(t,{clock:n,lastUpdated:o}),void 0===d&&null!==l?i.push(t):void 0!==d&&null===l?c.push(t):null!==l&&(ev(l,u)||a.push(t),r.push(t)))}(i.length>0||a.length>0||c.length>0)&&e.emit("change",[{added:i,updated:a,removed:c},n]),(i.length>0||r.length>0||c.length>0)&&e.emit("update",[{added:i,updated:r,removed:c},n])};class tl{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){let n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}let td=e=>em(e,(e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`).join("&");!function(e){e[e.Sync=0]="Sync",e[e.Awareness=1]="Awareness",e[e.Auth=2]="Auth",e[e.QueryAwareness=3]="QueryAwareness",e[e.Stateless=5]="Stateless",e[e.CLOSE=7]="CLOSE",e[e.SyncStatus=8]="SyncStatus"}(r||(r={})),function(e){e.Connecting="connecting",e.Connected="connected",e.Disconnected="disconnected"}(a||(a={}));class tu{constructor(e){this.data=e,this.encoder=eI(),this.decoder=e$(new Uint8Array(this.data))}peekVarString(){return eX(this.decoder)}readVarUint(){return eQ(this.decoder)}readVarString(){return eK(this.decoder)}readVarUint8Array(){return eJ(this.decoder)}writeVarUint(e){return eN(this.encoder,e)}writeVarString(e){return ez(this.encoder,e)}writeVarUint8Array(e){return eF(this.encoder,e)}length(){return eR(this.encoder)}}class th extends tl{constructor(e){if(super(),this.messageQueue=[],this.configuration={url:"",document:void 0,WebSocketPolyfill:void 0,parameters:{},connect:!0,broadcast:!0,forceSyncInterval:!1,messageReconnectTimeout:3e4,delay:1e3,initialDelay:0,factor:2,maxAttempts:0,minDelay:1e3,maxDelay:3e4,jitter:!0,timeout:0,onOpen:()=>null,onConnect:()=>null,onMessage:()=>null,onOutgoingMessage:()=>null,onStatus:()=>null,onDisconnect:()=>null,onClose:()=>null,onDestroy:()=>null,onAwarenessUpdate:()=>null,onAwarenessChange:()=>null,quiet:!1,providerMap:new Map},this.webSocket=null,this.webSocketHandlers={},this.shouldConnect=!0,this.status=a.Disconnected,this.lastMessageReceived=0,this.identifier=0,this.intervals={forceSync:null,connectionChecker:null},this.connectionAttempt=null,this.receivedOnOpenPayload=void 0,this.receivedOnStatusPayload=void 0,this.closeTries=0,this.setConfiguration(e),this.configuration.WebSocketPolyfill=e.WebSocketPolyfill?e.WebSocketPolyfill:WebSocket,this.on("open",this.configuration.onOpen),this.on("open",this.onOpen.bind(this)),this.on("connect",this.configuration.onConnect),this.on("message",this.configuration.onMessage),this.on("outgoingMessage",this.configuration.onOutgoingMessage),this.on("status",this.configuration.onStatus),this.on("status",this.onStatus.bind(this)),this.on("disconnect",this.configuration.onDisconnect),this.on("close",this.configuration.onClose),this.on("destroy",this.configuration.onDestroy),this.on("awarenessUpdate",this.configuration.onAwarenessUpdate),this.on("awarenessChange",this.configuration.onAwarenessChange),this.on("close",this.onClose.bind(this)),this.on("message",this.onMessage.bind(this)),this.intervals.connectionChecker=setInterval(this.checkConnection.bind(this),this.configuration.messageReconnectTimeout/10),void 0!==e.connect&&(this.shouldConnect=e.connect),!this.shouldConnect)return;this.connect()}async onOpen(e){this.receivedOnOpenPayload=e}async onStatus(e){this.receivedOnStatusPayload=e}attach(e){let t;return this.configuration.providerMap.set(e.configuration.name,e),this.status===a.Disconnected&&this.shouldConnect&&(t=this.connect()),this.receivedOnOpenPayload&&e.onOpen(this.receivedOnOpenPayload),this.receivedOnStatusPayload&&e.onStatus(this.receivedOnStatusPayload),t}detach(e){this.configuration.providerMap.delete(e.configuration.name)}setConfiguration(e={}){this.configuration={...this.configuration,...e}}async connect(){let e;if(this.status===a.Connected)return;this.cancelWebsocketRetry&&(this.cancelWebsocketRetry(),this.cancelWebsocketRetry=void 0),this.receivedOnOpenPayload=void 0,this.receivedOnStatusPayload=void 0,this.shouldConnect=!0;let{retryPromise:t,cancelFunc:n}=(e=!1,{retryPromise:$(this.createWebSocketConnection.bind(this),{delay:this.configuration.delay,initialDelay:this.configuration.initialDelay,factor:this.configuration.factor,maxAttempts:this.configuration.maxAttempts,minDelay:this.configuration.minDelay,maxDelay:this.configuration.maxDelay,jitter:this.configuration.jitter,timeout:this.configuration.timeout,beforeAttempt:t=>{(!this.shouldConnect||e)&&t.abort()}}).catch(e=>{if(e&&"ATTEMPT_ABORTED"!==e.code)throw e}),cancelFunc:()=>{e=!0}});return this.cancelWebsocketRetry=n,t}attachWebSocketListeners(e,t){let{identifier:n}=e;this.webSocketHandlers[n]={message:e=>this.emit("message",e),close:e=>this.emit("close",{event:e}),open:e=>this.emit("open",e),error:e=>{t(e)}};let s=this.webSocketHandlers[e.identifier];Object.keys(s).forEach(t=>{e.addEventListener(t,s[t])})}cleanupWebSocket(){if(!this.webSocket)return;let{identifier:e}=this.webSocket,t=this.webSocketHandlers[e];Object.keys(t).forEach(n=>{var s;null==(s=this.webSocket)||s.removeEventListener(n,t[n]),delete this.webSocketHandlers[e]}),this.webSocket.close(),this.webSocket=null}createWebSocketConnection(){return new Promise((e,t)=>{this.webSocket&&(this.messageQueue=[],this.cleanupWebSocket()),this.lastMessageReceived=0,this.identifier+=1;let n=new this.configuration.WebSocketPolyfill(this.url);n.binaryType="arraybuffer",n.identifier=this.identifier,this.attachWebSocketListeners(n,t),this.webSocket=n,this.status=a.Connecting,this.emit("status",{status:a.Connecting}),this.connectionAttempt={resolve:e,reject:t}})}onMessage(e){var t;this.resolveConnectionAttempt(),this.lastMessageReceived=ts();let n=new tu(e.data).peekVarString();null==(t=this.configuration.providerMap.get(n))||t.onMessage(e)}resolveConnectionAttempt(){this.connectionAttempt&&(this.connectionAttempt.resolve(),this.connectionAttempt=null,this.status=a.Connected,this.emit("status",{status:a.Connected}),this.emit("connect"),this.messageQueue.forEach(e=>this.send(e)),this.messageQueue=[])}stopConnectionAttempt(){this.connectionAttempt=null}rejectConnectionAttempt(){var e;null==(e=this.connectionAttempt)||e.reject(),this.connectionAttempt=null}checkConnection(){var e;this.status===a.Connected&&this.lastMessageReceived&&(this.configuration.messageReconnectTimeout>=ts()-this.lastMessageReceived||(this.closeTries+=1,this.closeTries>2?(this.onClose({event:{code:4408,reason:"forced"}}),this.closeTries=0):(null==(e=this.webSocket)||e.close(),this.messageQueue=[])))}get serverUrl(){for(;"/"===this.configuration.url[this.configuration.url.length-1];)return this.configuration.url.slice(0,this.configuration.url.length-1);return this.configuration.url}get url(){let e=td(this.configuration.parameters);return`${this.serverUrl}${0===e.length?"":`?${e}`}`}disconnect(){if(this.shouldConnect=!1,null!==this.webSocket)try{this.webSocket.close(),this.messageQueue=[]}catch{}}send(e){var t;(null==(t=this.webSocket)?void 0:t.readyState)===i.Open?this.webSocket.send(e):this.messageQueue.push(e)}onClose({event:e}){if(this.closeTries=0,this.cleanupWebSocket(),this.status===a.Connected&&(this.status=a.Disconnected,this.emit("status",{status:a.Disconnected}),this.emit("disconnect",{event:e})),e.code===H.code&&(e.reason===H.reason?console.warn("[HocuspocusProvider] An authentication token is required, but you didn’t send one. Try adding a `token` to your HocuspocusProvider configuration. Won’t try again."):console.warn(`[HocuspocusProvider] Connection closed with status Unauthorized: ${e.reason}`),this.shouldConnect=!1),e.code===F.code&&!this.configuration.quiet)return void console.warn("[HocuspocusProvider] The provided authentication token isn’t allowed to connect to this server. Will try again.");e.code===z.code&&(console.warn(`[HocuspocusProvider] Connection closed with status MessageTooBig: ${e.reason}`),this.shouldConnect=!1),this.connectionAttempt?this.rejectConnectionAttempt():this.shouldConnect&&this.connect(),this.shouldConnect||this.status!==a.Disconnected&&(this.status=a.Disconnected,this.emit("status",{status:a.Disconnected}),this.emit("disconnect",{event:e}))}destroy(){this.emit("destroy"),this.intervals.forceSync&&clearInterval(this.intervals.forceSync),clearInterval(this.intervals.connectionChecker),this.stopConnectionAttempt(),this.disconnect(),this.removeAllListeners(),this.cleanupWebSocket()}}let tp=(e,t)=>{eN(e,0),eF(e,V.FX(t))},tg=(e,t,n)=>{eN(e,1),eF(e,V.PR(t,n))},tf=(e,t,n)=>tg(t,n,eJ(e)),tm=(e,t,n)=>{try{V.QE(t,eJ(e),n)}catch(e){console.error("Caught error while handling a Yjs update",e)}},ty=(e,t)=>{eN(e,2),eF(e,t)},tb=(e,t,n,s)=>{let o=eQ(e);switch(o){case 0:tf(e,t,n);break;case 1:case 2:tm(e,n,s);break;default:throw Error("Unknown message type")}return o};class tw{constructor(){this.encoder=eI()}get(e){return e.encoder}toUint8Array(){return e_(this.encoder)}}class tv{constructor(e){this.broadcasted=!1,this.message=e}setBroadcasted(e){return this.broadcasted=e,this}apply(e,t){let{message:n}=this,s=n.readVarUint(),o=n.length();switch(s){case r.Sync:this.applySyncMessage(e,t);break;case r.Awareness:this.applyAwarenessMessage(e);break;case r.Auth:this.applyAuthMessage(e);break;case r.QueryAwareness:this.applyQueryAwarenessMessage(e);break;case r.Stateless:e.receiveStateless(eK(n.decoder));break;case r.SyncStatus:this.applySyncStatusMessage(e,1===eZ(n.decoder));break;default:throw Error(`Can’t apply message of unknown type: ${s}`)}n.length()>o+1&&(this.broadcasted?e.broadcast(tw,{encoder:n.encoder}):e.send(tw,{encoder:n.encoder}))}applySyncMessage(e,t){let{message:n}=this;n.writeVarUint(r.Sync);let s=tb(n.decoder,n.encoder,e.document,e);t&&1===s&&(e.synced=!0)}applySyncStatusMessage(e,t){t&&e.decrementUnsyncedChanges()}applyAwarenessMessage(e){if(!e.awareness)return;let{message:t}=this;tc(e.awareness,t.readVarUint8Array(),e)}applyAuthMessage(e){let{message:t}=this;L(t.decoder,e.permissionDeniedHandler.bind(e),e.authenticatedHandler.bind(e))}applyQueryAwarenessMessage(e){if(!e.awareness)return;let{message:t}=this;t.writeVarUint(r.Awareness),t.writeVarUint8Array(ta(e.awareness,Array.from(e.awareness.getStates().keys())))}}class tS{constructor(e,t={}){this.message=new e,this.encoder=this.message.get(t)}create(){return e_(this.encoder)}send(e){null==e||e.send(this.create())}broadcast(e){tt(e,this.create())}}class tx extends tw{constructor(){super(...arguments),this.type=r.Auth,this.description="Authentication"}get(e){if(void 0===e.token)throw Error("The authentication message requires `token` as an argument.");return ez(this.encoder,e.documentName),eN(this.encoder,this.type),U(this.encoder,e.token),this.encoder}}class tC extends tw{constructor(){super(...arguments),this.type=r.Awareness,this.description="Awareness states update"}get(e){let t;if(void 0===e.awareness)throw Error("The awareness message requires awareness as an argument");if(void 0===e.clients)throw Error("The awareness message requires clients as an argument");return ez(this.encoder,e.documentName),eN(this.encoder,this.type),t=void 0===e.states?ta(e.awareness,e.clients):ta(e.awareness,e.clients,e.states),eF(this.encoder,t),this.encoder}}class tA extends tw{constructor(){super(...arguments),this.type=r.CLOSE,this.description="Ask the server to close the connection"}get(e){return ez(this.encoder,e.documentName),eN(this.encoder,this.type),this.encoder}}class tk extends tw{constructor(){super(...arguments),this.type=r.QueryAwareness,this.description="Queries awareness states"}get(e){return ez(this.encoder,e.documentName),eN(this.encoder,this.type),this.encoder}}class tE extends tw{constructor(){super(...arguments),this.type=r.Stateless,this.description="A stateless message"}get(e){var t;return ez(this.encoder,e.documentName),eN(this.encoder,this.type),ez(this.encoder,null!=(t=e.payload)?t:""),this.encoder}}class tT extends tw{constructor(){super(...arguments),this.type=r.Sync,this.description="First sync step"}get(e){if(void 0===e.document)throw Error("The sync step one message requires document as an argument");return ez(this.encoder,e.documentName),eN(this.encoder,this.type),tp(this.encoder,e.document),this.encoder}}class tD extends tw{constructor(){super(...arguments),this.type=r.Sync,this.description="Second sync step"}get(e){if(void 0===e.document)throw Error("The sync step two message requires document as an argument");return ez(this.encoder,e.documentName),eN(this.encoder,this.type),tg(this.encoder,e.document),this.encoder}}class tP extends tw{constructor(){super(...arguments),this.type=r.Sync,this.description="A document update"}get(e){return ez(this.encoder,e.documentName),eN(this.encoder,this.type),ty(this.encoder,e.update),this.encoder}}class tM extends Error{constructor(){super(...arguments),this.code=1001}}class tO extends tl{constructor(e){var t,n,s;super(),this.configuration={name:"",document:void 0,awareness:void 0,token:null,parameters:{},broadcast:!0,forceSyncInterval:!1,onAuthenticated:()=>null,onAuthenticationFailed:()=>null,onOpen:()=>null,onConnect:()=>null,onMessage:()=>null,onOutgoingMessage:()=>null,onStatus:()=>null,onSynced:()=>null,onDisconnect:()=>null,onClose:()=>null,onDestroy:()=>null,onAwarenessUpdate:()=>null,onAwarenessChange:()=>null,onStateless:()=>null,quiet:!1,connect:!0,preserveConnection:!0},this.subscribedToBroadcastChannel=!1,this.isSynced=!1,this.unsyncedChanges=0,this.status=a.Disconnected,this.isAuthenticated=!1,this.authorizedScope=void 0,this.mux=tn(),this.intervals={forceSync:null},this.isConnected=!0,this.boundDocumentUpdateHandler=this.documentUpdateHandler.bind(this),this.boundAwarenessUpdateHandler=this.awarenessUpdateHandler.bind(this),this.boundBroadcastChannelSubscriber=this.broadcastChannelSubscriber.bind(this),this.boundPageHide=this.pageHide.bind(this),this.boundOnOpen=this.onOpen.bind(this),this.boundOnClose=this.onClose.bind(this),this.boundOnStatus=this.onStatus.bind(this),this.forwardConnect=e=>this.emit("connect",e),this.forwardOpen=e=>this.emit("open",e),this.forwardClose=e=>this.emit("close",e),this.forwardDisconnect=e=>this.emit("disconnect",e),this.forwardDestroy=e=>this.emit("destroy",e),this.setConfiguration(e),this.configuration.document=e.document?e.document:new V.JA,this.configuration.awareness=void 0!==e.awareness?e.awareness:new ti(this.document),this.on("open",this.configuration.onOpen),this.on("message",this.configuration.onMessage),this.on("outgoingMessage",this.configuration.onOutgoingMessage),this.on("synced",this.configuration.onSynced),this.on("destroy",this.configuration.onDestroy),this.on("awarenessUpdate",this.configuration.onAwarenessUpdate),this.on("awarenessChange",this.configuration.onAwarenessChange),this.on("stateless",this.configuration.onStateless),this.on("authenticated",this.configuration.onAuthenticated),this.on("authenticationFailed",this.configuration.onAuthenticationFailed),this.configuration.websocketProvider.on("connect",this.configuration.onConnect),this.configuration.websocketProvider.on("connect",this.forwardConnect),this.configuration.websocketProvider.on("open",this.boundOnOpen),this.configuration.websocketProvider.on("open",this.forwardOpen),this.configuration.websocketProvider.on("close",this.boundOnClose),this.configuration.websocketProvider.on("close",this.configuration.onClose),this.configuration.websocketProvider.on("close",this.forwardClose),this.configuration.websocketProvider.on("status",this.boundOnStatus),this.configuration.websocketProvider.on("disconnect",this.configuration.onDisconnect),this.configuration.websocketProvider.on("disconnect",this.forwardDisconnect),this.configuration.websocketProvider.on("destroy",this.configuration.onDestroy),this.configuration.websocketProvider.on("destroy",this.forwardDestroy),null==(t=this.awareness)||t.on("update",()=>{this.emit("awarenessUpdate",{states:B(this.awareness.getStates())})}),null==(n=this.awareness)||n.on("change",()=>{this.emit("awarenessChange",{states:B(this.awareness.getStates())})}),this.document.on("update",this.boundDocumentUpdateHandler),null==(s=this.awareness)||s.on("update",this.boundAwarenessUpdateHandler),this.registerEventListeners(),this.configuration.forceSyncInterval&&"number"==typeof this.configuration.forceSyncInterval&&(this.intervals.forceSync=setInterval(this.forceSync.bind(this),this.configuration.forceSyncInterval)),this.configuration.websocketProvider.attach(this)}onStatus({status:e}){this.status=e,this.configuration.onStatus({status:e}),this.emit("status",{status:e})}setConfiguration(e={}){!e.websocketProvider&&e.url&&(this.configuration.websocketProvider=new th({url:e.url,connect:e.connect,parameters:e.parameters})),this.configuration={...this.configuration,...e}}get document(){return this.configuration.document}get awareness(){return this.configuration.awareness}get hasUnsyncedChanges(){return this.unsyncedChanges>0}resetUnsyncedChanges(){this.unsyncedChanges=1,this.emit("unsyncedChanges",this.unsyncedChanges)}incrementUnsyncedChanges(){this.unsyncedChanges+=1,this.emit("unsyncedChanges",this.unsyncedChanges)}decrementUnsyncedChanges(){this.unsyncedChanges-=1,0===this.unsyncedChanges&&(this.synced=!0),this.emit("unsyncedChanges",this.unsyncedChanges)}forceSync(){this.resetUnsyncedChanges(),this.send(tT,{document:this.document,documentName:this.configuration.name})}pageHide(){this.awareness&&tr(this.awareness,[this.document.clientID],"page hide")}registerEventListeners(){"undefined"!=typeof window&&"addEventListener"in window&&window.addEventListener("pagehide",this.boundPageHide)}sendStateless(e){this.send(tE,{documentName:this.configuration.name,payload:e})}documentUpdateHandler(e,t){t!==this&&(this.incrementUnsyncedChanges(),this.send(tP,{update:e,documentName:this.configuration.name},!0))}awarenessUpdateHandler({added:e,updated:t,removed:n},s){let o=e.concat(t).concat(n);this.send(tC,{awareness:this.awareness,clients:o,documentName:this.configuration.name},!0)}get synced(){return this.isSynced}set synced(e){this.isSynced!==e&&(this.isSynced=e,this.emit("synced",{state:e}),this.emit("sync",{state:e}))}receiveStateless(e){this.emit("stateless",{payload:e})}get isAuthenticationRequired(){return!!this.configuration.token&&!this.isAuthenticated}async connect(){return this.configuration.broadcast&&this.subscribeToBroadcastChannel(),this.configuration.websocketProvider.shouldConnect=!0,this.configuration.websocketProvider.attach(this)}disconnect(){this.disconnectBroadcastChannel(),this.configuration.websocketProvider.detach(this),this.isConnected=!1,this.configuration.preserveConnection||this.configuration.websocketProvider.disconnect()}async onOpen(e){let t;this.isAuthenticated=!1,this.isConnected=!0,this.emit("open",{event:e});try{t=await this.getToken()}catch(e){this.permissionDeniedHandler(`Failed to get token: ${e}`);return}this.isAuthenticationRequired&&this.send(tx,{token:t,documentName:this.configuration.name}),this.startSync()}async getToken(){return"function"==typeof this.configuration.token?await this.configuration.token():this.configuration.token}startSync(){this.resetUnsyncedChanges(),this.send(tT,{document:this.document,documentName:this.configuration.name}),this.awareness&&null!==this.awareness.getLocalState()&&this.send(tC,{awareness:this.awareness,clients:[this.document.clientID],documentName:this.configuration.name})}send(e,t,n=!1){if(!this.isConnected)return;n&&this.mux(()=>{this.broadcast(e,t)});let s=new tS(e,t);this.emit("outgoingMessage",{message:s.message}),s.send(this.configuration.websocketProvider)}onMessage(e){let t=new tu(e.data),n=t.readVarString();t.writeVarString(n),this.emit("message",{event:e,message:new tu(e.data)}),new tv(t).apply(this,!0)}onClose(e){this.isAuthenticated=!1,this.synced=!1,this.awareness&&tr(this.awareness,Array.from(this.awareness.getStates().keys()).filter(e=>e!==this.document.clientID),this)}destroy(){this.emit("destroy"),this.intervals.forceSync&&clearInterval(this.intervals.forceSync),this.awareness&&(tr(this.awareness,[this.document.clientID],"provider destroy"),this.awareness.off("update",this.boundAwarenessUpdateHandler),this.awareness.destroy()),this.document.off("update",this.boundDocumentUpdateHandler),this.removeAllListeners(),this.configuration.websocketProvider.off("connect",this.configuration.onConnect),this.configuration.websocketProvider.off("connect",this.forwardConnect),this.configuration.websocketProvider.off("open",this.boundOnOpen),this.configuration.websocketProvider.off("open",this.forwardOpen),this.configuration.websocketProvider.off("close",this.boundOnClose),this.configuration.websocketProvider.off("close",this.configuration.onClose),this.configuration.websocketProvider.off("close",this.forwardClose),this.configuration.websocketProvider.off("status",this.boundOnStatus),this.configuration.websocketProvider.off("disconnect",this.configuration.onDisconnect),this.configuration.websocketProvider.off("disconnect",this.forwardDisconnect),this.configuration.websocketProvider.off("destroy",this.configuration.onDestroy),this.configuration.websocketProvider.off("destroy",this.forwardDestroy),this.send(tA,{documentName:this.configuration.name}),this.disconnect(),"undefined"!=typeof window&&"removeEventListener"in window&&window.removeEventListener("pagehide",this.boundPageHide)}permissionDeniedHandler(e){this.emit("authenticationFailed",{reason:e}),this.isAuthenticated=!1,this.disconnect(),this.status=a.Disconnected}authenticatedHandler(e){this.isAuthenticated=!0,this.authorizedScope=e,this.emit("authenticated")}get broadcastChannel(){return`${this.configuration.name}`}broadcastChannelSubscriber(e){this.mux(()=>{let t=new tu(e),n=t.readVarString();t.writeVarString(n),new tv(t).setBroadcasted(!0).apply(this,!1)})}subscribeToBroadcastChannel(){this.subscribedToBroadcastChannel||(e9(this.broadcastChannel,this.boundBroadcastChannelSubscriber),this.subscribedToBroadcastChannel=!0),this.mux(()=>{this.broadcast(tT,{document:this.document,documentName:this.configuration.name}),this.broadcast(tD,{document:this.document,documentName:this.configuration.name}),this.broadcast(tk,{document:this.document,documentName:this.configuration.name}),this.awareness&&this.broadcast(tC,{awareness:this.awareness,clients:[this.document.clientID],document:this.document,documentName:this.configuration.name})})}disconnectBroadcastChannel(){this.awareness&&this.send(tC,{awareness:this.awareness,clients:[this.document.clientID],states:new Map,documentName:this.configuration.name},!0),this.subscribedToBroadcastChannel&&(te(this.broadcastChannel,this.boundBroadcastChannelSubscriber),this.subscribedToBroadcastChannel=!1)}broadcast(e,t){this.configuration.broadcast&&this.subscribedToBroadcastChannel&&new tS(e,t).broadcast(this.broadcastChannel)}setAwarenessField(e,t){if(!this.awareness)throw new tM(`Cannot set awareness field "${e}" to ${JSON.stringify(t)}. You have disabled Awareness for this provider by explicitly passing awareness: null in the provider configuration.`);this.awareness.setLocalStateField(e,t)}}crypto.getRandomValues.bind(crypto);var tI=n(39891),tR=n(55729),t_=n(57067),tj=n(91938),tN=n(8335),tU=n(82328),tL=n(65280),tz=n(95578),tH=n(32617),tF=n(5291),tB=n(59190),tV=n(15342),tG=n(91792),tW=n(30188),t$=n(18341),tY=n(85057),tJ=n(35625),tq=n(17928),tQ=n(47296),tZ=n(70651),tK=n(29147),tX=n(49377),t0=n(28144),t1=n(40313),t2=n(99492),t8=n(48621),t3=n(80910),t6=n(77650),t5=n(90184),t4=n(22905),t7=n(33201),t9=n(58082),ne=n(47665);let nt=(e,t)=>{let n,s,{state:o}=e;if(!o)return;let i=[];try{(n=(0,t4.eL)(null==e?void 0:e.state.doc.resolve(o.selection.from),ne.jg))&&(i=(0,t7.j5)(e,n.pos),s=(0,t9.x)(i,t).isCardDark)}catch(e){console.error(e)}return s};var nn=n(43634),ns=n(63867);let no=new ns.hs("autocompleteButton"),ni=(0,tR.memo)(e=>{let{editor:t}=e,n=tz.of.get("arrowAutocomplete"),[s,o]=(0,tR.useState)(null),[i,r]=(0,tR.useState)(null),{hideTooltips:a,GammaTooltipHiderContext:c}=(0,t3.ku)();return((0,tR.useEffect)(()=>{t&&t.commands.command(e=>{let{tr:t}=e;return t.setMeta(no,{buttonElement:i,tippyTarget:s,onHide:a}),!0})},[t,s,i,a]),n)?(0,l.jsx)("div",{ref:o,style:{visibility:"hidden"},children:(0,l.jsx)(tX.s,{ref:r,children:(0,l.jsx)(c,{children:(0,l.jsx)(nr,{editor:t})})})}):null});ni.displayName="AutocompleteButton";let nr=e=>{let{editor:t}=e,n=(0,tV.GV)(nn.SJ),s=(0,tG.rd)(),[o,i]=(0,tR.useState)(s);return(0,tR.useEffect)(()=>{if(!t)return;let e=()=>{let e=nt(t,n);i(void 0!==e?e:s)};return e(),t.on("selectionUpdate",e),()=>{t.off("selectionUpdate",e)}},[t,s,n]),(0,l.jsx)(t3.L8,{isDark:o,children:(0,l.jsx)(t3.Tz,{label:(0,l.jsxs)(t0.z,{gap:.5,children:[(0,l.jsx)(g.E,{children:t6.Ru._({id:"ZyVTQp"})}),(0,l.jsx)(t5.G,{type:"autocomplete",bg:"transparent",p:0}),(0,l.jsx)(t3.iM,{shortcut:"Tab"})]}),placement:"top",children:(0,l.jsx)(t1.$,{variant:"plain",size:"xs",padding:"1px 2px",borderRadius:"4px",background:"none",fontSize:"0.7em",transition:"var(--chakra-transition-property-colors)",children:(0,l.jsx)(t8.g,{icon:t2.up_})})})})};var na=n(67733),nc=n(40240),nl=n(41427),nd=n(46609);let nu=e=>e.pos+e.node.nodeSize-1;class nh{initialize(e){let{buttonElement:t,tippyTarget:n,onHide:s}=e;if(this.isFlagEnabled){if(!t||!n)return void console.warn("[AutocompleteButtonView] initialize. No element provided");this.element=t,this.target=n,this.onHide=s,this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.createTooltip(),this.element.style.visibility="visible"}}createTooltip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!this.isFlagEnabled)return;let n=t||this.view.dom.parentElement;n&&this.element&&(this.tippy=(0,na.Ay)(n,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",offset:[0,5],...e}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(e,t){if(!this.isFlagEnabled)return;let{state:n,composing:s}=e,{doc:o,selection:i}=n,r=t&&no.getState(t),a=no.getState(e.state),c=t&&t.doc.eq(o)&&t.selection.eq(i)&&this.isEditable===this.editor.isEditable&&(null==r?void 0:r.forceHide)===a.forceHide;if(!this.element||!this.target){if(!a.buttonElement||!a.tippyTarget)return;this.initialize(a)}let l=!(null==t?void 0:t.selection.eq(i)),d=!(null==t?void 0:t.doc.eq(o));if(this.isEditable=this.editor.isEditable,!this.editor.isEditable||!0===a.forceHide)return void this.hide();if(!s&&!c)if(l&&!d){if(!this.shouldShow({view:e,state:n}))return void this.hide();this.show()}else d&&(this.hide(),this.typingTimeout&&clearTimeout(this.typingTimeout),this.typingTimeout=setTimeout(()=>{this.editor&&this.view.hasFocus()&&this.shouldShow({view:e,state:this.editor.state})&&this.show()},750))}show(){var e,t;if(!this.isFlagEnabled||!this.validParentNode||(this.nodeEndPos=nu(this.validParentNode),!this.nodeEndPos))return;let n=(0,nl.KQ)(this.validParentNode.node);null==(e=this.tippy)||e.setProps({getReferenceClientRect:()=>(0,t4.MG)(this.editor.view,this.nodeEndPos||0,this.nodeEndPos||0),placement:"rtl"===n?"left":"right"}),this.element&&(this.element.style.transform="rtl"===n?"scaleX(-1)":"none"),null==(t=this.tippy)||t.show()}hide(){var e;this.isFlagEnabled&&(this.onHide&&"function"==typeof this.onHide&&this.onHide(),null==(e=this.tippy)||e.hide())}destroy(){var e,t,n;this.isFlagEnabled&&(this.typingTimeout&&clearTimeout(this.typingTimeout),(null==(e=this.tippy)?void 0:e.popper.firstChild)&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),null==(t=this.tippy)||t.destroy(),null==(n=this.element)||n.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler))}constructor({editor:e,view:t}){this.element=null,this.target=null,this.preventHide=!1,this.typingTimeout=null,this.validParentNode=null,this.nodeEndPos=null,this.mousedownHandler=()=>{this.nodeEndPos&&this.isFlagEnabled&&(this.preventHide=!0,this.editor.commands.setTextSelection(this.nodeEndPos),setTimeout(()=>{(0,nc.py)(),this.editor.commands.autoComplete(),this.hide()}))},this.focusHandler=()=>{setTimeout(()=>this.update(this.view))},this.blurHandler=e=>{var t,n;let{event:s}=e;if(this.preventHide){this.preventHide=!1;return}(null==s?void 0:s.relatedTarget)&&(null==(n=this.element)||null==(t=n.parentNode)?void 0:t.contains(s.relatedTarget))||(null==s?void 0:s.relatedTarget)!==this.editor.view.dom&&this.hide()},this.tippyBlurHandler=e=>{this.blurHandler({event:e})},this.shouldShow=e=>{let{view:t,state:n}=e;return!!this.isFlagEnabled&&(this.validParentNode=(0,nd.B)({view:t,state:n,isFlagEnabled:this.isFlagEnabled,editor:this.editor}),!!this.validParentNode)},this.isFlagEnabled=tz.of.get("arrowAutocomplete"),this.editor=e,this.view=t,this.isEditable=e.isEditable}}let np=t4.YY.create({name:"autocompleteButton",addCommands:()=>({forceHideAutocompleteButton:e=>t=>{let{tr:n}=t;return n.setMeta(no,{forceHide:e}),!0}}),addProseMirrorPlugins(){let{editor:e}=this;return[new ns.k_({key:no,state:{init:()=>({buttonElement:null,tippyTarget:null,forceHide:!1,onHide:()=>{}}),apply(e,t){let n=e.getMeta(no);return n?{...t,...n}:t}},view:t=>new nh({view:t,editor:e})})]}});var ng=n(20824),nf=n(19564),nm=n(73320),ny=n(12417),nb=n(669);let nw=(0,tR.memo)(e=>{let{editor:t}=e;return tz.of.get("arrowAutocomplete")?(0,l.jsx)(nm.mM,{editor:t,updateDelay:0,shouldShow:()=>{let e=nb.nD.getState(t.view.state),n=t.view.state.selection;return!!e&&!!e.insertedRange&&null!==e.insertedRange.to&&e.insertedRange.to===n.from},tippyOptions:{placement:"bottom",hideOnClick:!1,offset:[0,5]},children:(0,l.jsx)(nv,{editor:t})}):null});nw.displayName="AutocompleteFeedback";let nv=e=>{let{editor:t}=e,n=(0,tV.GV)(nn.SJ),s=(0,tG.rd)(),[o,i]=(0,tR.useState)(s),[r,a]=(0,tR.useState)(null),c=(0,tR.useRef)(null);(0,tR.useEffect)(()=>{if(!t)return;let e=()=>{a(null);let e=nt(t,n);i(void 0!==e?e:s)};return e(),t.on("selectionUpdate",e),()=>{t.off("selectionUpdate",e)}},[t,s,n]),(0,ng.j)({ref:c,handler:e=>{let n=e.target.closest("[data-rating-buttons]"),s=e.target.closest("[data-rating-popover]");if(n||s)return;let o=nb.nD.getState(t.view.state);console.log("pluginState",o),o&&o.insertedRange&&null!==o.insertedRange.from&&t.commands.setMeta("autocompleteEvent",{type:"reset"})}});let d=(0,tR.useCallback)((e,n,s)=>{var o;let i=null==(o=no.getState(t.state))?void 0:o.interactionId;(0,nc.xj)({feedback:n,tags:s,rating:e,interactionId:i})},[t]),u=(0,tR.useCallback)(e=>{var n;let s=null==(n=no.getState(t.state))?void 0:n.interactionId;a(e),(0,nc.Dx)({rating:e,interactionId:s})},[t]);return(0,l.jsx)(t3.L8,{isDark:o,children:(0,l.jsx)(tX.s,{ref:c,backgroundColor:o?"gray.900":"gray.200",p:1,borderRadius:"md",position:"relative",_before:{content:'""',position:"absolute",top:"-4px",left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"4px solid transparent",borderRight:"4px solid transparent",borderBottom:"4px solid ".concat(o?"var(--chakra-colors-gray-900)":"var(--chakra-colors-gray-200)")},children:(0,l.jsx)(ny.f3,{rating:r||void 0,setRating:u,trackFeedback:d,RatingButtons:ny.Ep,feedbackTags:nS(),size:"xs"})})})},nS=()=>[{key:"too-long",label:(0,l.jsx)(nf.x6,{id:"yIsdT7"})},{key:"too-short",label:(0,l.jsx)(nf.x6,{id:"CALFDl"})},{key:"didnt-follow-prompt",label:(0,l.jsx)(nf.x6,{id:"xZPdUv"})},{key:"wrong-formatting",label:(0,l.jsx)(nf.x6,{id:"4xQrPc"})}];var nx=n(29586),nC=n(78116),nA=n(60016),nk=n(46794),nE=n(65286),nT=n(14083),nD=n(54327),nP=n(64877),nM=n(6901),nO=n(60080),nI=n(67839),nR=n(97481),n_=n.n(nR),nj=n(33612),nN=n.n(nj);let nU=(e,t,n)=>{let s=e.resolve(t),o=e.resolve(n),i=s.nodeAfter,r=o.nodeBefore;return!!(i&&(0,ne.jg)(i)&&r&&(0,ne.jg)(r)&&i===r)};var nL=n(60122),nz=n(46814),nH=n(30963);let nF=(e,t,n)=>e!==t,nB=e=>{let t=document.createElement("span");t.classList.add("ProseMirror-yjs-cursor"),t.setAttribute("style","border-color: ".concat(e.color));let n=document.createElement("div");n.setAttribute("style","background-color: ".concat(e.color)),n.insertBefore(document.createTextNode(e.name),null);let s=document.createTextNode("⁠"),o=document.createTextNode("⁠");return t.insertBefore(s,null),t.insertBefore(n,null),t.insertBefore(o,null),t},nV=e=>({style:"background-color: ".concat(e.color,"70"),class:"ProseMirror-yjs-selection"}),nG=(e,t)=>(n,s,o,i)=>{let r=[];r.push(c.NZ.widget(i,()=>t(n),{key:s+"",side:10}));let a=nH.jk(o,i),l=nH.T9(o,i);return r.push(c.NZ.inline(a,l,e(n),{inclusiveEnd:!0,inclusiveStart:!1})),r},nW=/^#[0-9a-fA-F]{6}$/,n$=(e,t,n,s)=>{let o=nL.pJ.getState(e),i=o.doc,r=[];return null!=o.snapshot||null!=o.prevSnapshot||null===o.binding?c.zF.create(e.doc,[]):(t.getStates().forEach((t,a)=>{if(n(i.clientID,a,t)&&null!=t.cursor){let n=t.user||{};null==n.color?n.color="#ffa500":nW.test(n.color)||console.warn("A user uses an unsupported color format",n),null==n.name&&(n.name="User: ".concat(a));let c=(0,nz.bL)(i,o.type,V.sH(t.cursor.anchor),o.binding.mapping),l=(0,nz.bL)(i,o.type,V.sH(t.cursor.head),o.binding.mapping);if(null!==c&&null!==l){let t=nH.T9(e.doc.content.size-1,0);c=nH.jk(c,t),l=nH.jk(l,t),r.push(...s(e,n,a,c,l))}}}),c.zF.create(e.doc,r))},nY=function(e){let{awarenessStateFilter:t=nF,cursorBuilder:n=nB,selectionBuilder:s=nV,getSelection:o=e=>e.selection,createCursorDecorations:i=nG(s,n)}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cursor";return new ns.k_({key:nL.S6,state:{init:(n,s)=>n$(s,e,t,i),apply(n,s,o,r){let a=nL.pJ.getState(r),c=n.getMeta(nL.S6);return a&&a.isChangeOrigin||c&&c.awarenessUpdated?n$(r,e,t,i):s.map(n.mapping,n.doc)}},props:{decorations:e=>nL.S6.getState(e)},view:t=>{let n=()=>{t.docView&&(0,nz.iZ)(t,nL.S6,{awarenessUpdated:!0})},s=()=>{let n=nL.pJ.getState(t.state),s=e.getLocalState()||{};if(null!=n.binding)if(t.hasFocus()){let i=o(t.state),a=(0,nz.Bw)(i.anchor,n.type,n.binding.mapping),c=(0,nz.Bw)(i.head,n.type,n.binding.mapping);null!=s.cursor&&V.uG(V.sH(s.cursor.anchor),a)&&V.uG(V.sH(s.cursor.head),c)||e.setLocalStateField(r,{anchor:a,head:c})}else null!=s.cursor&&null!==(0,nz.bL)(n.doc,n.type,V.sH(s.cursor.anchor),n.binding.mapping)&&e.setLocalStateField(r,null)};return e.on("change",n),t.dom.addEventListener("focusin",s),t.dom.addEventListener("focusout",s),{update:s,destroy:()=>{t.dom.removeEventListener("focusin",s),t.dom.removeEventListener("focusout",s),e.off("change",n),e.setLocalStateField(r,null)}}}})},nJ=()=>null,nq=e=>Array.from(e.entries()).map(e=>{let[t,n]=e;return{clientId:t,...n.user}}),nQ=t4.YY.create({name:"collaborationCursor",addOptions:()=>({provider:null,user:{name:null,color:null},render:e=>{let t=document.createElement("span");if(!e.isReady)return t;t.classList.add("collaboration-cursor__caret"),t.setAttribute("style","border-color: ".concat(e.color));let n=document.createElement("div");n.classList.add("collaboration-cursor__label"),n.setAttribute("style","background-color: ".concat(e.color,"; color: ").concat(nN()(e.color).isDark()?"white":"black"));let s=e.name.split(" ")[0];return n.insertBefore(document.createTextNode(s),null),t.insertBefore(n,null),t},buildSelection:e=>({style:"background-color: ".concat(e.color,"70"),class:"ProseMirror-yjs-selection"}),onUpdate:nJ}),addStorage:()=>({users:[]}),addCommands(){return{user:e=>()=>(this.options.user=n_()({},this.options.user,e),this.options.provider.awareness.setLocalStateField("user",this.options.user),!0)}},addProseMirrorPlugins(){return[nY((this.options.provider.awareness.setLocalStateField("user",this.options.user),this.storage.users=nq(this.options.provider.awareness.states),this.options.provider.awareness.on("update",()=>{this.storage.users=nq(this.options.provider.awareness.states)}),this.options.provider.awareness),{createCursorDecorations:(e,t,n,s,o)=>{let i=[];if(nU(e.doc,s,o))return i;i.push(c.NZ.widget(o,()=>this.options.render(t),{key:n+"",side:10}));let r=s<o?s:o,a=s>o?s:o;return i.push(c.NZ.inline(r,a,this.options.buildSelection(t),{inclusiveEnd:!0,inclusiveStart:!1})),i}})]}});var nZ=n(38934),nK=n(7915);let nX=t4.YY.create({name:"globalDragHandle",priority:nZ.y.GlobalDragHandle,addOptions:()=>({scrollerSelector:"body"}),addStorage:()=>({enabled:!0}),addProseMirrorPlugins(){return[(0,nK.l)({editor:this.editor,storage:this.storage,scrollerSelector:this.options.scrollerSelector})]},extendNodeSchema(e){var t;return{containerHandle:null!=(t=(0,t4.gk)((0,t4.iI)(e,"containerHandle",e)))&&t}}});var n0=n(1739),n1=n(24926),n2=n(94282);let n8=new ns.hs("erasingContent");class n3{toJSON(){return{datetime:this.timestamp.toISOString(),meta:this.tr.meta,steps:this.tr.steps.map(e=>e.toJSON())}}constructor(e){this.tr=e,this.timestamp=new Date(new Date().toLocaleString("en-US",{timeZone:"America/Los_Angeles"}))}}class n6{apply(e,t){return e.docChanged&&(this.transactions.unshift(new n3(e)),this.transactions.length>5&&this.transactions.pop()),this}constructor(){this.transactions=[]}}class n5 extends Error{constructor(e){super(e||"Content erased"),this.name="ContentErasedError"}}let n4=t4.YY.create({name:"ErasingContent",addProseMirrorPlugins(){let e=this,t=t=>{try{var n;let s=(0,t$.HW)();for(let t of this.options.messageLogger.flushMessages()){let n={...t.toDebugObject(),clientID:e.options.provider.document.clientID};n1.yf.logger.info(t.toString(),n),console.log(t.toString(),n)}let o=Math.floor(performance.now()-this.options.startTime),i={event:"CONTENT_ERASED",didFilterTransaction:t.didFilterTransaction,tr:t.tr.toJSON(),prevTrs:null==(n=t.prevTrs)?void 0:n.map(e=>e.toJSON()),timeSinceOpened:o,isBackgrounded:!!document.hidden,docId:this.options.provider.configuration.name,clientID:this.options.provider.document.clientID,userId:null==s?void 0:s.id};n1.yf.logger.error("[ErasingContent] ".concat(o," content erased (FILTERED: ").concat(t.didFilterTransaction,")"),i),n2.Cp(new n5)}catch(e){console.error("Failed to log content erased",e),n2.Cp(e)}};return[new ns.k_({key:n8,filterTransaction:(e,n)=>{if(!e.docChanged)return!0;let s=n.doc.type.createAndFill().content;if(null===e.doc.content.findDiffStart(s)){let s=new n3(e),o=n8.getState(n),i=tz.of.get("filterContentErasingTrs");return t({tr:s,didFilterTransaction:i,prevTrs:null==o?void 0:o.transactions}),!i}return!0},state:{init:()=>new n6,apply:(e,t,n,s)=>t.apply(e,s)}})]}});var n7=n(86932),n9=n(82636),se=n(43028),st=n(45574),sn=n(2320),ss=n(8294),so=n(25600),si=n(25105),sr=n(27196),sa=n(51817),sc=n(8972),sl=n(82759),sd=n(21157),su=n.n(sd),sh=n(80911);let sp=e=>{let{editor:t}=e,[n,s]=(0,tR.useState)(null);(0,tR.useEffect)(()=>{if(!t)return;let e=()=>{s(t.state.selection)};return e(),t.on("selectionUpdate",e),()=>{t.off("selectionUpdate",e)}},[t]);let o=n instanceof ns.nh,i=n instanceof sh.J,r=su()((null==n?void 0:n.toJSON().type)||"none"),a=su()(o&&(null==n?void 0:n.node.type.name)||""),c=i?void 0:o?"blue":"green";return(0,l.jsx)(sc.Z,{children:(0,l.jsx)(tX.s,{className:"selection-debugger",position:"absolute",top:"50px",left:"10px",zIndex:"999999",children:(0,l.jsxs)(h.B,{direction:"column",children:[(0,l.jsxs)(sl.E,{colorScheme:c,children:[r,a&&(0,l.jsxs)("i",{children:[" (",a,")"]})]}),n&&(0,l.jsxs)(sl.E,{colorScheme:"gray",children:["f:",n.from," - t:",n.to,i&&" | side:".concat(n.side)]})]})})})};var sg=n(12364),sf=n.n(sg),sm=n(58495),sy=n(74158),sb=n(68986),sw=n(65148);let sv=(0,sm.d_)("1234567890",10),sS=()=>{let e=sb.e.getItem(sw.E.sessionId);if(e)return e;let t="".concat(+new Date,"__").concat(sv());return sb.e.setItem(sw.E.sessionId,t),t},sx=(e,t)=>{let{user:n,isUserLoading:s,anonymousUser:o,color:i}=(0,t$.ur)(),r=(0,tR.useRef)(!1),a=(0,sy.wA)(),c=(0,tR.useMemo)(()=>sS(),[]),l=(0,tV.GV)(nn.l$),d=(0,tR.useMemo)(()=>({id:(null==n?void 0:n.id)||o.id,color:i.value,sessionId:l?c+"__pv":c,isPresenterView:l,idleSince:null,name:(null==n?void 0:n.displayName)||o.displayName||"",profileImageUrl:(null==n?void 0:n.profileImageUrl)||"",isReady:!s,spotlight:{pos:null,cardId:null}}),[n,i,s,l,o,c]);(0,tR.useEffect)(()=>{if(!e||e.isDestroyed||!(null==t?void 0:t.awareness))return;e.commands.user(d),!r.current&&d.isReady&&(e.chain().blur().focusDelayed().run(),r.current=!0),a((0,nn.vK)({sessionId:d.sessionId}));let n=(e,n)=>{let{added:s,updated:o,removed:i}=e;requestIdleCallback(()=>{if(!t.awareness)return;let e=nq(t.awareness.states);a((0,nn._)({collaborators:e}))},{timeout:500})};t.awareness.on("change",n);let s=sf()(n,nn.Y5);return t.awareness.on("update",s),()=>{var e,o;null==(e=t.awareness)||e.off("change",n),null==(o=t.awareness)||o.off("update",s)}},[d,e,t,a]),(0,tR.useEffect)(()=>{if(!e)return;let t=sf()(t=>{e.commands.user(t)},10);return(0,tV.oM)(nn.kM,t)},[e])};var sC=n(96284),sA=n(22448),sk=n(10612),sE=n.n(sk),sT=n(42721);let sD=e=>JSON.stringify(Array.from(e.entries())),sP=e=>JSON.stringify(Array.from(e)),sM=e=>Array.from(e.entries()),sO=e=>e instanceof V.q7?{__type:e.constructor.name,id:e.id,length:e.length,info:e.info,parent:e.parent,parentSub:e.parentSub,content:{__type:e.content.constructor.name,...e.content}}:e,sI=()=>{let e=(0,sA.xv)();return(0,sA.Qj)(e,""),(0,sA.zd)(e,r.Sync),(0,sA.zd)(e,1),(0,sA.Gu)(e,new Uint8Array([])),(0,sA.Fo)(e)};class sR{setTransaction(e){this.transaction=e}shouldAssociateTransaction(){return!1}getPayload(){return{}}toString(){let e="in"===this.dir?"\uD83D\uDFE9⬇️":"\uD83D\uDFE6⬆️",t=sE()(String(this.timestamp),5);return"".concat("[HocuspocusMessage]"," ").concat(t," ").concat(e," ").concat(this.typeName)}toDebugObject(){var e;return{event:"hocuspocus-message",docId:this.docId,userId:null==(e=(0,sT.HW)())?void 0:e.id,hocuspocusMessage:{dir:this.dir,timestamp:this.timestamp,typeName:this.typeName,messageType:this.messageType,payload:this.getPayload()}}}static fromOutgoingMessage(e,t){let n=0===e.encoder.cpos&&0===e.encoder.bufs.length?sI():(0,sA.Fo)(e.encoder);return sR.fromData("out",n,t)}static fromIncomingMessage(e,t){return sR.fromData("in",new Uint8Array(e),t)}static fromData(e,t,n){let s=(0,sC.$C)(t),o=(0,sC.t3)(s);switch((0,sC.cw)(s)){case r.Sync:return new s_(o,e,s,n);case r.Awareness:return new sj(o,e,s,n);case r.Auth:return new sN(o,e,s,n);case r.QueryAwareness:return new sU(o,e,s,n);case r.Stateless:return new sL(o,e,s,n);case r.CLOSE:return new sz(o,e,s,n);case r.SyncStatus:return new sH(o,e,s,n);default:return new sR(o,e,n)}}constructor(e,t,n){this.docId=e,this.dir=t,this.timestamp=n,this.messageType=null,this.typeName="DebugHocuspocusMessage",this.transaction=null}}class s_ extends sR{getPayload(){let{transaction:e}=this,t=null,n=null;if(0===this.syncStep){var s;s=this.update,t=JSON.stringify(sM(V.Zx(s)))}else this.syncStep>0&&(n=function(e){try{let t=V.W3(new Uint8Array(e));return{ds:JSON.stringify(sM(t.ds.clients)),structs:JSON.stringify(t.structs.map(sO))}}catch(e){return{}}}(this.update));let o={syncStepName:this.syncStepName,syncStep:this.syncStep,update:sP(this.update),stateVector:t,decodedUpdate:n,transaction:null};return null!==e&&(o.transaction={beforeState:sD(e.beforeState),beforeStateSize:e.beforeState.size,afterState:sD(e.afterState),afterStateSize:e.afterState.size,changed:sD(e.changed),changedSize:e.changed.size,deleteSet:sD(e.deleteSet.clients),deleteSetSize:e.deleteSet.clients.size}),o}shouldAssociateTransaction(){return 2===this.syncStep}toString(){let e=super.toString();return"".concat(e," [step=").concat(this.syncStepName,"]")}constructor(e,t,n,s){super(e,t,s),this.messageType=r.Sync,this.typeName="Sync",this.syncStep=(0,sC.cw)(n),this.syncStepName=0===this.syncStep?"SyncStep1":1===this.syncStep?"SyncStep2":"Update",this.update=(0,sC.bo)(n)}}class sj extends sR{getPayload(){return{len:this.states.length,states:this.states}}constructor(e,t,n,s){super(e,t,s),this.messageType=r.Awareness,this.typeName="Awareness",this.states=[];let o=(0,sC.bo)(n),i=(0,sC.$C)(o),a=(0,sC.cw)(i);for(let e=0;e<a;e++){let e=(0,sC.cw)(i),t=(0,sC.cw)(i),n=(0,sC.t3)(i);this.states.push({clientId:e,clock:t,state:n})}}}class sN extends sR{getPayload(){return{authMessageType:this.authMessageTypeName,scope:this.scope}}toString(){let e=super.toString();return"".concat(e," [authType=").concat(this.authMessageTypeName,"]")}constructor(e,t,n,s){super(e,t,s),this.messageType=r.Auth,this.typeName="Auth",this.authMessageType=(0,sC.cw)(n),this.authMessageTypeName=0===this.authMessageType?"Token":1===this.authMessageType?"PermissionDenied":"Authenticated",this.scope=(0,sC.t3)(n)}}class sU extends sR{constructor(e,t,n,s){super(e,t,s),this.messageType=r.QueryAwareness,this.typeName="QueryAwareness"}}class sL extends sR{constructor(e,t,n,s){super(e,t,s),this.messageType=r.Stateless,this.typeName="Stateless"}}class sz extends sR{constructor(e,t,n,s){super(e,t,s),this.messageType=r.CLOSE,this.typeName="Close"}}class sH extends sR{getPayload(){return{saved:this.saved}}constructor(e,t,n,s){super(e,t,s),this.messageType=r.SyncStatus,this.typeName="SyncStatus",this.saved=1===(0,sC.cw)(n)}}let sF=()=>{let e=(0,tR.useRef)(null);return{onTransaction:(0,tR.useCallback)(t=>{e.current=t},[]),getTransaction:(0,tR.useCallback)(()=>{let t=e.current;return e.current=null,t},[])}};class sB{onMessage(e){e.messageType!==r.Awareness&&(this.buffer.push(e),this.buffer.length>this.bufferSize&&this.buffer.shift())}getMessages(){return this.buffer}flushMessages(){let e=this.buffer;return this.buffer=[],e}constructor(e=50){this.bufferSize=e,this.buffer=[]}}var sV=n(50333),sG=n.n(sV);let sW=e=>{let[t,n]=(0,tR.useState)([]);return{logMessages:t,logPerfMessage:(0,tR.useCallback)(t=>{if(!e)return;let s=performance.now(),o={msg:t,timestamp:s};n(e=>0===e.length?[...e,o]:e.find(e=>e.msg===t)||e[e.length-1].msg===t?e:(o.duration=sG()(s-e[e.length-1].timestamp,2),[...e,o]))},[e]),dumpLog:(0,tR.useCallback)(()=>{e&&n(e=>{try{console.table(e)}catch(e){}return[]})},[e])}};var s$=n(38451),sY=n(99038),sJ=n(37605);let sq="not-connecting-toast",sQ=()=>(0,l.jsx)(tX.s,{direction:"column",p:4,color:"white",bg:"yellow.500",borderRadius:"md",children:(0,l.jsxs)(tX.s,{alignItems:"center",children:[(0,l.jsx)(p.y,{mr:4}),(0,l.jsxs)(d.az,{ml:3,children:[(0,l.jsx)(g.E,{lineHeight:6,fontSize:"sm",fontWeight:"bold",children:(0,l.jsx)(nf.x6,{id:"9tGBiL",values:{GAMMA_ARTIFACT_PROPER_NOUN:sY.TP}})}),(0,l.jsx)(g.E,{lineHeight:6,fontSize:"sm",children:(0,l.jsx)(nf.x6,{id:"xpqx+T"})})]})]})}),sZ=e=>{let{enabled:t,docId:n}=e,s=(0,s$.d)(),o=(0,tR.useRef)(null),i=(0,tR.useCallback)(()=>{s.close(sq),o.current&&(clearTimeout(o.current),o.current=null)},[s]);return(0,tR.useEffect)(()=>{if(t)return o.current=setTimeout(()=>{s.isActive(sq)||(s({render:sQ,duration:null,id:sq}),n1.yf.logger.info("Editor slow load toast shown",{event:sJ.ng.EDITOR_SLOW_LOAD,docId:n}))},15e3),()=>{o.current&&(clearTimeout(o.current),o.current=null)}},[n,t,s]),i};var sK=n(12733),sX=n(67604),s0=n(23086),s1=n(62123),s2=n(88586),s8=n(25991),s3=n(86497);let s6=e=>{let t=(0,sX.A)(e);return 4>=Math.abs(function(e,t){(0,s1.A)(2,arguments);var n=(0,s0.A)(e,t)/36e5;return n>0?Math.floor(n):Math.ceil(n)}(new Date,t))},s5=(e,t)=>{let[n,s]=(0,tR.useState)(!1),o=(0,tR.useRef)(null);(0,tR.useEffect)(()=>{if(t){o.current&&clearTimeout(o.current),s(!1);return}return o.current=setTimeout(()=>{s(!0)},1e4),()=>{o.current&&clearTimeout(o.current)}},[t]);let i=(0,tV.GV)(s8.TT)[e];if(!i)return!1;let r=i.lastSynced;return!!(r&&s6(r))||n},s4=(e,t)=>{let{isInOfflineMode:n}=(0,s2.utY)(),s=(0,s3.O)(),o=(0,tV.GV)(s8.yy),i=s5(e,t);return n||(s||o)&&i};var s7=n(21638),s9=n(38859),oe=n(70205),ot=n(43162),on=n(27368),os=n(75846),oo=n(51684),oi=n(65905);let or=()=>!!window.navigator&&!1===window.navigator.onLine,oa=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4,[t,n]=(0,tR.useState)(or),s=(0,tR.useRef)(null);return(0,oi.LQ)("offline",()=>{s.current=setTimeout(()=>{n(!0)},e)}),(0,oi.LQ)("online",()=>{s.current&&(clearTimeout(s.current),s.current=null),n(!1)}),t};var oc=n(88608),ol=n(95889),od=n(43607),ou=n(69138),oh=n(29238);let op=async(e,t,n,s)=>{try{let{id:o,length:i}=n||{},r=await fetch("".concat(tj.$.MULTIPLAYER_WS_URL.replace("wss","https"),"/").concat(e,"/verify/").concat(t),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:o,length:i,clientCount:null==s?void 0:s.clientCount,totalCount:null==s?void 0:s.totalCount})});return await r.json()}catch(e){}},og=e=>{let t=e.document.store.clients.get(e.document.clientID);if(t&&t.length)return t[t.length-1]},of=e=>({clientCount:e.document.store.clients.size,totalCount:[...e.document.store.clients.values()].reduce((e,t)=>e+t.reduce((e,t)=>e+t.length,0),0)}),om=async(e,t,n)=>{let s=og(t),o=of(t),i=await op(e.gammaDocId,t.document.clientID,s,o);if(!i)return console.warn("[compareClocks] Failed to fetch remote clock"),!1;try{var r;let e=((null==s?void 0:s.id.clock)||0)+((null==s?void 0:s.length)||0),t=((null==i||null==(r=i.lastKnownItem.id)?void 0:r.clock)||0)+((null==i?void 0:i.lastKnownItem.length)||0),a=e-t;a>0&&console.warn("[compareClocks] Clock drift detected",{diffLastItem:a});let c=o.clientCount-(i.itemSummary.clientCount||0),l=o.totalCount-(i.itemSummary.totalCount||0);return c>0&&console.warn("[compareClocks] clientCount drift detected",{diffClientCount:c}),l>0&&console.warn("[compareClocks] totalCount drift detected",{diffTotalCount:l}),0===c&&l<=n&&a<=n}catch(e){console.warn("[compareClocks] Failed to fetch remote clock")}return!1},oy=e=>{let[t,n]=(0,tR.useState)(null==e?void 0:e.status);return(0,tR.useEffect)(()=>{if(!e)return;let t=e=>{let{status:t}=e;n(t)};return e.on("status",t),()=>{e.off("status",t)}},[e]),t},ob=e=>{let{editor:t,yProvider:n,enabled:s}=e,o=(0,tV.CU)(),[i,r]=(0,tR.useState)(Date.now()),[a,c]=(0,tR.useState)(0),l=oy(n),[d,u]=(0,tR.useState)(s);(0,tR.useEffect)(()=>{if(!s)return void u(!1);u(!1);let e=t_.wg(()=>{u(!0)},5e3);return()=>{t_.DJ(e)}},[s,l]);let h=(0,tz.u)("dataSyncClockDriftTolerance"),p=(0,tR.useCallback)(async()=>{if(!t||!n||!t.gammaDocId)return;let{online:e,backgrounded:s}=(0,oh.mN)(o.getState());e&&!s&&(await om(t,n,h)?(c(0),r(Date.now())):(c(e=>e+1),console.warn("[useDataPersistenceSync_2] Clocks out of sync for doc",t.gammaDocId)))},[h,t,o,n]),g=0===a?2e4:4e3;return(0,tR.useEffect)(()=>{if(!t||!n||!d)return;let e=setInterval(()=>{p()},g);return()=>{e&&clearInterval(e)}},[t,n,d,g,h,p]),{errorCount:a,yDocLastSynced:i,checkDataInSync:p}},ow="data-sync-error-toast",ov="data-sync-not-saved-toast",oS=(0,l.jsx)(t8.g,{icon:oo.lEd,size:"2x"}),ox=(0,l.jsx)(t8.g,{icon:oo.JAe,size:"2x"}),oC=e=>{let{type:t,yDocLastSynced:n}=e;return()=>(0,l.jsx)(tX.s,{direction:"column",p:4,color:"white",bg:"warn"===t?"yellow.500":"red.500",borderRadius:"md",children:(0,l.jsxs)(tX.s,{alignItems:"center",children:["warn"===t?oS:ox,(0,l.jsxs)(d.az,{ml:3,children:[(0,l.jsx)(g.E,{lineHeight:6,fontSize:"sm",fontWeight:"bold",children:"warn"===t?(0,l.jsx)(nf.x6,{id:"BM8j3v",values:{GAMMA_PROPER_NOUN:sY.On}}):(0,l.jsx)(nf.x6,{id:"DgKz0c",values:{GAMMA_PROPER_NOUN:sY.On}})}),n&&(0,l.jsx)(g.E,{lineHeight:6,fontSize:"sm",children:(0,l.jsx)(nf.x6,{id:"VxWwaW",values:{0:(0,oc.Bo)(new Date(n).toISOString())}})}),"error"===t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s7.c,{pt:2}),(0,l.jsx)(g.E,{lineHeight:6,fontSize:"sm",pt:2,children:(0,l.jsx)(nf.x6,{id:"Pw5K5r"})})]})]})]})})},oA=e=>{let{onClose:t}=e;return(0,l.jsxs)(s9.F,{variant:"light",status:"info",alignItems:"start",borderRadius:"md",boxShadow:"lg",paddingEnd:8,textAlign:"start",width:"auto",children:[(0,l.jsx)(oe._,{}),(0,l.jsxs)(d.az,{flex:"1",maxWidth:"100%",children:[(0,l.jsx)(ot.X,{children:(0,l.jsx)(nf.x6,{id:"BM8j3v",values:{GAMMA_PROPER_NOUN:sY.On}})}),(0,l.jsx)(on.T,{display:"block",children:(0,l.jsx)(nf.x6,{id:"I1QCnH"})})]}),(0,l.jsx)(os.J,{size:"sm",onClick:t,position:"absolute",insetEnd:1,top:1})]})},ok=e=>{let{enabled:t,errorCount:n,errorCountThreshold:s,isPresentModeAndNotEditing:o,background:i,offline:r}=e;return!t||o||i||r||-1===s?"ignored":n>2*s?"error":n>s?"warn":"ok"},oE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3,[t,n]=(0,tR.useState)(!0),s=(0,tR.useRef)(null);return(0,oi.LQ)("foreground",t=>{let{timeInBackground:o}=t;if(null===o)return void n(!0);if(o>6e4){s.current=setTimeout(()=>{n(!0)},e);return}n(!0)}),(0,oi.LQ)("background",()=>{s.current&&(clearTimeout(s.current),s.current=null),n(!1)}),t},oT=e=>{let{offline:t,yDocLastSynced:n}=e,s=(0,s$.d)(),[o,i]=(0,tR.useState)(!1),r=(0,s3.O)(),a=(0,tV.GV)(s8.yy),c=(r||a)&&!t;return(0,tR.useMemo)(()=>({warnOrError:e=>{if(c)return!s.isActive(ov)&&!o&&(s({id:ov,duration:null,render:e=>{let{onClose:t}=e;return oA({onClose:()=>{t(),i(!0)}})}}),!0);let t=oC({type:e,yDocLastSynced:n});return s.isActive(ow)?(s.update(ow,{render:t}),!1):(s({render:t,duration:null,id:ow}),!0)},recovered:e=>!!(c?s.isActive(ov)||o:s.isActive(ow))&&((s.isActive(ow)||s.isActive(ov))&&s.closeAll(),"ignored"!==e&&(c&&(s({title:(0,l.jsx)(nf.x6,{id:"flElqq",values:{GAMMA_PROPER_NOUN:sY.On}}),description:(0,l.jsx)(nf.x6,{id:"Gm5OG1"}),status:"success",duration:5e3,id:"data-sync-saved-toast",isClosable:!0}),i(!1)),!0))}),[o,s,c,n])},oD=e=>{let{editor:t,yProvider:n,enabled:s}=e,o=(0,tV.GV)(nn.VJ),i=(0,od.UT)("comment"),r=(0,tV.GV)(nn.jn),a=(0,ol.st)(),{user:c}=(0,t$.ur)(),l=(0,tR.useRef)(),d=(0,tz.u)("dataSyncErrorThreshold"),{errorCount:u,yDocLastSynced:h}=ob({editor:t,yProvider:n,enabled:s&&i}),p={docSavedTime:r,yDocLastSynced:h,errorCount:u,clientID:null==n?void 0:n.document.clientID,userId:null==c?void 0:c.id},g=(0,tR.useRef)(p);g.current=p;let f=oa(),m=oE(),y=(0,tR.useRef)();y.current={errorCount:u,enabled:s,errorCountThreshold:d,isPresentModeAndNotEditing:o,background:!m,offline:f};let b=ok(y.current),w=oT({offline:f,yDocLastSynced:h});return(0,ou.V)(()=>{if("ok"===b||"ignored"===b){if(!w.recovered(b))return;let e=l.current?new Date-l.current:void 0;null==a||a.trackDocEvent(ol.ng.DATA_SYNC_RECOVER,{...g.current,duration:e}),n1.yf.logger.info("Data sync recovered",{event:ol.ng.DATA_SYNC_RECOVER,docId:null==t?void 0:t.gammaDocId,errorStatusInput:y.current,docEventData:g.current}),l.current=void 0;return}w.warnOrError(b)&&(null==a||a.trackDocEvent(ol.ng.DATA_SYNC_ERROR,g.current),n1.yf.logger.info("Data sync error",{event:ol.ng.DATA_SYNC_ERROR,docId:null==t?void 0:t.gammaDocId,dataSyncErrorType:b,errorStatusInput:y.current,docEventData:g.current}),"error"===b&&n2.Cp("[useDataPersistenceSync] ERROR_THRESHOLD_EXCEEDED. docId: ".concat(null==t?void 0:t.gammaDocId)))},[a,null==t?void 0:t.gammaDocId,b,w],[b]),"error"===b},oP=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=(0,tR.useRef)(0),s=(0,tR.useRef)(0),[o,i]=(0,tR.useState)(!1),[r,a]=(0,tR.useState)(0),[c,l]=(0,tR.useState)(document.hidden),d=(0,tR.useRef)(()=>{n.current++,n.current>=t&&(console.warn("[useRateLimiter] Limit hit! (".concat(t," per ").concat(e/1e3,"s)")),o||(i(!0),a(e=>e+1))),s.current||(s.current=t_.yb(()=>{n.current>0?n.current--:(i(!1),t_.vG(s.current),s.current=0)},e/t))});return(0,tR.useEffect)(()=>{let e=()=>{l(document.hidden),d.current()};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[]),[d.current,o,r,c]};var oM=n(31922);let oO=()=>(0,l.jsxs)(oM.T,{align:"flex-end",borderRadius:"base",shadow:"lg",p:3,bg:"gray.100",spacing:4,maxW:"300px",direction:"row",children:[(0,l.jsxs)(d.az,{children:[(0,l.jsx)(g.E,{fontSize:"md",fontWeight:"bold",children:(0,l.jsx)(nf.x6,{id:"8kh5VW",values:{GAMMA_PROPER_NOUN:sY.On}})}),(0,l.jsxs)(g.E,{fontSize:"sm",children:[(0,l.jsx)(nf.x6,{id:"CDva2g"})," ",(0,l.jsx)("em",{children:(0,l.jsx)(nf.x6,{id:"/vuJlA"})})," ","\uD83D\uDE0E"]})]}),(0,l.jsx)(d.az,{children:(0,l.jsx)(t1.$,{size:"sm",onClick:()=>{window.location.reload()},children:(0,l.jsx)(nf.x6,{id:"HpK/8d"})})})]}),oI=e=>{let t=(0,s$.d)(),[n,s]=(0,tR.useState)(!1);return(0,tR.useEffect)(()=>{if(!e)return;let t=()=>{let t=e.getMap("SCHEMA_VERSION").get("REQUIRED_VERSION"),n=!!(t&&t>sa.f$);s(n),console[n?"warn":"debug"]("[SchemaVerifier] onUpdate",{requiredVersion:t,MY_VERSION:sa.f$,outdated:n})};return e.on("update",t),()=>{e.off("update",t)}},[e]),(0,tR.useEffect)(()=>{n&&!t.isActive("schema_outdated")&&t({id:"schema_outdated",duration:null,status:"warning",isClosable:!1,position:"bottom-left",render:oO})},[n,t]),n},oR="staging"===tj.$.APPLICATION_ENVIRONMENT&&tj.$.API_HOST.endsWith("api-custom-backend.staging.gamma.app"),o_=e=>({DOC_ID:e,SCHEMA_VERSION:String(sa.f$),SHARE_TOKEN:tj.$.SHARE_TOKEN,...oR?{API_HOST:tj.$.API_HOST}:{}}),oj=(0,tR.memo)(e=>{let{doc:t,docId:n,onCreate:s,readOnly:o=!1,scrollingParentSelector:i,hideForPreview:r=!1,animationsExtensionEnabled:a=!1}=e,[c]=(0,tR.useState)(()=>performance.now()),{timeOnCreate:f,timeOnSetupProvider:m,timeOnDownloadDoc:y}=(0,tB.n6)(),b=(0,tG.rd)(),{isUserLoading:w}=(0,t$.ur)(),[v,S]=(0,tR.useState)(!1),x=(0,tR.useRef)(!1);x.current=v;let[C,A]=(0,tR.useState)(!1),[k,E]=(0,tR.useState)(!1),T=(0,tR.useRef)([]),[D,P]=(0,tR.useState)(),[M,O]=(0,tR.useState)(),[I,R]=(0,tR.useState)(),[_]=(0,tR.useState)(()=>new sB),{onTransaction:j,getTransaction:N}=sF(),U=(0,tF.iJ)(),L=(0,tF.iO)(),{isConnected:z}=(0,tU.u)(),F=s4(n,C),B=oI(M);sx(D,I);let G=oD({editor:D,yProvider:I,enabled:C&&!o});(0,sr.Rf)(D);let[W,$,Y,J]=oP(),q=t&&t.organization&&t.organization.id,Q=sZ({docId:n,enabled:!C}),Z=(0,tH.u)("debugLogging"),K=(0,tV.GV)(tz.Gm),X=(0,tH.u)("waitForGammaPersistenceMeta"),ee=(0,tV.jL)(),{logMessages:et,logPerfMessage:en,dumpLog:es}=sW(Z);(0,tY.C)((0,tR.useCallback)(()=>{I&&(I.disconnect(),I.configuration.parameters=o_(n),setTimeout(()=>I.connect(),500))},[I,n])),(0,tN.A)(),(0,sK.W)(D),(0,tR.useEffect)(()=>{let e;if(!I)return;let t=Y>10;if($){console.warn("[CollaborativeEditor] Attempted to re-connect while rate limited (".concat(Y," of ").concat(10,").")),I.disconnect();return}if(t){console.error("[CollaborativeEditor - RECONNECT_RATE_LIMIT] Max rate limit violations reached (".concat(10,"). Will reload.")),setTimeout(()=>{window.location.reload()},500);return}if(x.current)return J?(console.debug("[CollaborativeEditor] Backgrounded, will wait ".concat(12e4,"s before disconnect")),e=t_.wg(()=>{console.debug("[CollaborativeEditor] Disconnecting after grace period"),I.disconnect()},12e4)):(console.debug("[CollaborativeEditor] Foregrounded, so re-connecting"),I.connect()),()=>{e&&t_.DJ(e)}},[I,J,$,Y]),(0,tR.useEffect)(()=>{D&&!D.isDestroyed&&q&&(D.commands.initializeUploadExtension(q),D.commands.removeGeneratorInputsOnLoad())},[D,q]),(0,tR.useEffect)(()=>{M&&n&&F&&U.loadYDoc(n,M,()=>{console.debug("offlineMode - [ydocOfflineApi] YDoc loaded from indexeddb"),A(!0),S(!0)})},[F,M,n,U]),(0,tR.useEffect)(()=>{console.debug("[CollaborativeEditor] Creating yProvider for doc",n);let e=new V.JA({});e.getXmlFragment("default").observeDeep((e,t)=>{j(t)}),O(e),e.getMap("GammaPersistenceMeta").observeDeep((t,n)=>{e.getMap("GammaPersistenceMeta").get("READY")&&(en("Document data downloaded"),E(!0))}),en("Setting up hocuspocus"),m();let t=new tO({name:n,document:e,forceSyncInterval:15e3,token:o_(n).SHARE_TOKEN||"null",websocketProvider:new th({url:tj.$.MULTIPLAYER_WS_URL,parameters:o_(n)}),preserveConnection:!1,onOutgoingMessage(e){let{message:t}=e;try{let e=Math.floor(performance.now()-c),n=sR.fromOutgoingMessage(t,e);n.shouldAssociateTransaction()&&n.setTransaction(N()),_.onMessage(n)}catch(e){console.error("[CollaborativeEditor] Error processing outgoing message for debug",e)}},onMessage(e){let{message:t}=e;try{let e=Math.floor(performance.now()-c),n=sR.fromIncomingMessage(t.data,e);n.shouldAssociateTransaction()&&n.setTransaction(N()),_.onMessage(n)}catch(e){console.error("[CollaborativeEditor] Error processing incoming message for debug",e)}},onOpen(){if(!0===tz.of.get("hocuspocusOnAuthenticate"))return void console.log("[CollaborativeEditor] Provider opened. onAuthenticate is enabled so this is a no-op.");t.isAuthenticated=!0,console.log("[CollaborativeEditor] Provider opened.  Setting isAuthenticated to true.")},onStatus(e){let{status:t}=e;console.debug("[CollaborativeEditor][onStatus]",{status:t}),"connected"===t?(en("Hocuspocus connected"),S(!0),x.current=!0):"connecting"===t&&(en("Hocuspocus connecting"),W())},onSynced(){console.debug("[CollaborativeEditor] Provider synced"),A(!0),Q(),en("Document data downloaded"),U.syncYDoc(n,e)},onDisconnect(e){let{event:n}=e;n.code===H.code?console.error('[CollaborativeEditor] Provider disconnected with "Unauthorized.code", which is unexpected.',n):1008===n.code&&(t.disconnect(),tq.LF.emit(tq.DN.Y_DOC_IS_TOO_LARGE,{}),console.error("[CollaborativeEditor][onDisconnect] Document is too large, disconnecting"))}});return t.subscribeToBroadcastChannel(),R(t),ee((0,nn.gS)({hocuspocusProvider:t})),tj.$.DEBUG_ENABLED&&(window.gammaEditorProvider=t),T.current=[...a?[nC.Q]:[],se.EX,ss.q,sr.Li.configure({scrollerSelector:i}),nO.O.configure({document:e}),nI.F,tQ.b.configure({provider:t}),nQ.configure({provider:t}),nA.T.configure({document:e}),nE.$,nT.R,nk.$.configure(),np,nD.mM,si.V,tZ.d.configure({document:e}),nx.e,sn.c,n0.mk,st.Q8,n7.wg,so.bU,tI.o5.configure({openDoubleQuote:!1,closeDoubleQuote:!1,openSingleQuote:!1,closeSingleQuote:!1}),nX.configure({scrollerSelector:i}),tK.j,nM.p,nP.c,n9.H,tW.o.configure({document:e}),n4.configure({startTime:c,messageLogger:_,provider:t})],()=>{console.warn("[CollaborativeEditor] Destroying yProvider for doc ➡️",n),t.disconnect(),t.destroy(),delete window.gammaEditorProvider,R(void 0),A(!1),S(!1),E(!1),setTimeout(()=>{if(t&&t.awareness)try{t.awareness.destroy()}catch(e){console.warn("[CollaborativeEditor] Error destroying awareness provider.")}})}},[]);let eo=!!(v&&C&&(!X||k)&&t&&!w);(0,tR.useEffect)(()=>{eo&&(en("Is ready for TipTap"),y())},[eo,y,en]);let ei=(0,tL.K)();return(0,l.jsxs)(d.az,{display:r?"none":"block",w:"100%","data-testid":"collaborative-editor-wrapper",children:[eo&&K&&(0,l.jsx)(sp,{editor:D}),!D&&(0,l.jsx)(d.az,{flexDirection:"column",flex:"1",w:"100%",h:"var(--100vh)",bg:b?"gray.900":"gray.100",zIndex:"overlay","data-testid":"collaborative-editor-skeleton",inset:0,children:(0,l.jsx)(u.o,{h:"100%",children:(0,l.jsxs)(h.B,{align:"center",children:[(0,l.jsx)(p.y,{}),et.map((e,t)=>{let{msg:n}=e;return(0,l.jsx)(g.E,{children:n},t)})]})})}),eo&&(0,l.jsx)(tJ.b,{extensions:T.current,doc:t,docId:n,editorId:"main",onCreate:e=>{let{editor:t}=e;setTimeout(()=>{P(t),s&&s(t),requestAnimationFrame(()=>{z&&L(n),ei(t),en("Editor rendered"),f(),es()})},10)},readOnly:B||o||!F&&G,shouldSupportComments:!0,shouldSupportMenus:!0,scrollingParentSelector:i}),D&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ni,{editor:D}),(0,l.jsx)(nw,{editor:D})]})]})});var oN=n(3115),oU=n(74127)},27196:(e,t,n)=>{"use strict";n.d(t,{Li:()=>s.Li,Rf:()=>o.R,kY:()=>o.k});var s=n(60300),o=n(69764)},30188:(e,t,n)=>{"use strict";n.d(t,{b:()=>a,o:()=>c});var s=n(22905),o=n(63867),i=n(59023);let r=new o.hs("yDocSize"),a=e=>{let t=r.getState(e.state);return t?t.getYDocSize():null},c=s.YY.create({name:"yDocSize",addProseMirrorPlugins(){let{document:e}=this.options;return[new o.k_({key:r,state:{init:()=>new l(e),apply:(e,t)=>t}})]}});class l{getYDocSize(){return i.PR(this.ydoc).byteLength}constructor(e){this.ydoc=e}}},51817:(e,t,n)=>{"use strict";n.d(t,{f$:()=>o}),n(20178);let s=new URLSearchParams(window.location.search),o=(s.get("SCHEMA_VERSION")?Number(s.get("SCHEMA_VERSION")):null)||120},61121:(e,t,n)=>{"use strict";n.d(t,{GO:()=>T,h3:()=>E,wn:()=>P,SS:()=>D,ZY:()=>_,er:()=>k,Gi:()=>I});var s=n(3704),o=n(22905),i=n(63867),r=n(97255),a=n(15342),c=n(43634),l=n(85235),d=n(33201),u=n(67864);let h=e=>"buttonGroup"===e.type.name;var p=n(86958),g=n(6845),f=n(94922),m=n(98968),y=n(55424),b=n(60300),w=n(56124),v=n(85570),S=n(60122),x=n(56603);let C=()=>({absPositions:[],relPositions:[]});class A{getPositions(e){return e?this.presentModePositions:this.editModePositions}apply(e,t){let n=e.getMeta(v.g);if(n)switch(n.type){case"addAnimationPositions":this.addAnimationPositions(n.pos,t,n.isPresentMode);break;case"resetAnimationPositions":this.resetAnimationPositions(n.isPresentMode);break;case"enableAnimations":this.enabled=n.enabled;break;default:console.warn("AnimationsState: unknown action type",n)}return this}addAnimationPositions(e,t,n){let s=this.getPositions(n),o=Math.max(...s.absPositions);e.forEach(e=>{if(e<=o)return;s.absPositions.push(e);let n=(0,x.JO)(t,e);n&&s.relPositions.push(n)})}resetAnimationPositions(e){e?this.presentModePositions=C():this.editModePositions=C()}getAnimationPositionsAbs(e,t){let n=S.pJ.getState(e),s=this.getPositions(t);return n?s.relPositions.map(t=>(0,x.d_)(e,t)).filter(Boolean):s.absPositions}constructor(){this.enabled=!0,this.presentModePositions=C(),this.editModePositions=C()}}let k="animate-has-animated",E="animatable-on-load",T="animatable-on-load-as-block",D="animatable-on-load-content-parent",P="animatable-on-load-content-child",M=e=>{switch(e.type.name){case"card":return!0===(0,g.Wq)(e);case"cardAccentLayoutItem":return(0,f.wL)(e);case"calloutBox":case"gallery":case"smartLayout":case"divider":return!0;default:return(0,b.Rj)(e)}},O=(e,t)=>(0,y.q)(e)||(0,m.qK)(t),I=(e,t)=>{let n=e.view.state.doc.resolve(t);if(!n)return;let s=e.state.doc.nodeAt(t);if(s&&M(s)&&!O(s,n)){let e=s.isLeaf||s.isAtom?0:-1;return{pos:n.pos+e,start:n.pos,depth:n.depth,node:s}}return(0,o.eL)(n,M)},R=(e,t)=>{let n=t.getAnimationPositionsAbs(e,(0,c.wC)((0,a.KA)().getState())===l.w.SLIDE_VIEW).reduce((e,t)=>Math.max(e,t),0),s=e.doc.nodeAt(n),o=s&&n>0?s.nodeSize:0;return n+o},_=()=>new i.k_({key:v.g,state:{init:()=>new A,apply:(e,t,n,s)=>t.apply(e,s)},props:{decorations(e){let t=[],n=this.getState(e);if(!1===n.enabled)return r.zF.create(e.doc,t);let o=R(e,n);return e.doc.descendants((n,i,a,c)=>{let l=e.doc.resolve(i),g=M(n)||O(n,l);if(i<o&&g&&t.push(r.NZ.node(i,i+n.nodeSize,{class:k})),(0,y.M)(n)||(0,m.Pb)(n))t.push(r.NZ.node(i,i+n.nodeSize,{class:D}));else if(h(n)||(0,p.q)(n)||(0,w.hj)(n))t.push(r.NZ.node(i,i+n.nodeSize,{class:T}));else if(O(n,l))t.push(r.NZ.node(i,i+n.nodeSize,{class:P,style:"--animate-index: ".concat(c+1)}));else if(M(n)){let e=!!a&&(0,u.Ti)(n,a),o=n.isAtom;t.push(r.NZ.node(i,i+n.nodeSize,{class:(0,s.cx)(E,e&&"animatable-on-load-annotatable",o&&"animatable-on-load-atom")})),(0,f.wL)(n)&&t.push(r.NZ.node(i,i+n.nodeSize,{class:"animatable-on-load-accent"}))}return!((0,d.jg)(n)&&l.depth>1||(0,y.q)(n)||h(n)||(0,p.q)(n)||(0,w.hj)(n))}),r.zF.create(e.doc,t)}}})},64806:e=>{var t=Math.floor;e.exports=function(e,n){var s="";if(!e||n<1||n>0x1fffffffffffff)return s;do n%2&&(s+=e),(n=t(n/2))&&(e+=e);while(n);return s}},69764:(e,t,n)=>{"use strict";n.d(t,{R:()=>d,k:()=>l});var s=n(83817),o=n.n(s),i=n(55729),r=n(15342),a=n(43634),c=n(60300);let l=e=>{let t=(0,r.GV)(a.FI,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return o()(...t)});return(0,i.useMemo)(()=>({enabled:!!(e&&t&&(0,c.UE)(e,t)),pos:null==t?void 0:t.pos}),[e,t])},d=e=>{let t=(0,r.GV)(a.e4),n=(0,r.GV)(a._I,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return o()(...t)});(0,i.useEffect)(()=>{if(!e||!t||!n)return;console.debug("[useScrollAndSpotlightSync] collaboratorBeingFollowed spotlight or scroll changed",JSON.stringify(n,null,2));let{spotlight:s,scroll:o}=n;e.commands.syncSpotlightAndScroll({spotlight:s,scroll:o,scrollOffset:100,isFollowing:!0})},[e,t,n])}},74127:(e,t,n)=>{"use strict";n.d(t,{u:()=>a});var s=n(6029),o=n(74158),i=n(20011),r=n(35625);let a=e=>{let{...t}=e,{reduxData:n,...a}=t,c=(0,i.F)(n);return(0,s.jsx)(o.Kq,{store:c,children:(0,s.jsx)(r.b,{...a,readOnly:!0,isStatic:!0,animationsEnabled:!1})})}},78116:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var s=n(22905),o=n(61121),i=n(85570);let r=s.YY.create({name:"animations",addOptions:()=>({}),addCommands:()=>({addAnimationPositions:(e,t)=>n=>{let{state:s,dispatch:o}=n;return o&&s.tr.setMeta(i.g,{type:"addAnimationPositions",isPresentMode:t,pos:e}),!0},enableAnimations:e=>t=>{let{state:n,dispatch:s}=t;return s&&n.tr.setMeta(i.g,{type:"enableAnimations",enabled:e}),!0},resetAnimationPositions:e=>t=>{let{state:n,dispatch:s}=t;return s&&n.tr.setMeta(i.g,{type:"resetAnimationPositions",isPresentMode:e}),!0}}),addProseMirrorPlugins:()=>[(0,o.ZY)()]})},85570:(e,t,n)=>{"use strict";n.d(t,{g:()=>s});let s=new(n(63867)).hs("animation")},86497:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});var s=n(32617),o=n(5291);let i=()=>{let e=(0,s.u)("offlineEditing"),t=(0,o.b9)();return e&&t}}}]);
//# sourceMappingURL=5172-9b72d0127638653a.js.map